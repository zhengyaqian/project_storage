<!doctype html>
<html>

<head>
	<title>火绒终端安全控制中心</title>
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" />
	<link rel="stylesheet" href="css/font-awesome-4.7.0/css/font-awesome.css" />
	<link href="css/common.css" rel="stylesheet">
	<link rel="stylesheet" href="css/eventLog.css" />
	<link href="css/defendTactics.css" rel="stylesheet">
	<link href="css/checkTactics.css" rel="stylesheet">
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script src="js/lc_switch.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript" src="js/json3.js"></script>
	<script type="text/javascript" src="js/zUI.js"></script>
	<link rel="stylesheet" href="css/lc_switch.css">

</head>
<style>
	.mainBlock .leftScroll {
		overflow-y: scroll !important;
		width: 172px;
		height: 444px;
		padding-top: 14px;
		padding-bottom: 14px;
		float: left;
		position: relative;
		background-color: rgb(249, 249, 249);
	}

	.mainBlock .left .zUIpanelScrollBox,
	.groupsPage .zUIpanelScrollBar {
		width: 10px;
		top: 4px;
		border-radius: 5px;
	}

	.mainBlock .left .zUIpanelScrollBox {
		background: black;
		opacity: 0;
		filter: alpha(opacity=0);
	}

	.mainBlock .leftScroll .container1 {
		width: 100%;
	}

	.mainBlock .leftScroll .title {
		cursor: default;
		line-height: 32px;
		font-size: 12px;
		position: relative;
		font-weight: 700
	}

	.mainBlock .leftScroll a {
		cursor: pointer;
		display: block;
		padding-left: 54px;
		line-height: 26px;
		color: #6c6c6c;
		font-size: 12px
	}

	.mainBlock .leftScroll img {
		position: absolute;
		top: 10px;
		left: 24px
	}

	.mainBlock .leftScroll a:hover {
		background-color: #ffffff;
		color: #5fc47f
	}

	.mainBlock .leftScroll .title:hover {
		background-color: rgb(249, 249, 249);
		color: #6c6c6c
	}

	.mainBlock .leftScroll .current {
		color: #5fc47f;
		background-color: #ffffff
	}

	.th-ordery img {
		top: 22px
	}
	.expandTool{
		width: 90px;
		height: 94px;
		float: left;
		margin-right: 32px;
		text-align: center;
		margin-bottom: 10px;
	}
</style>

<body>
	<div class="main">
		<div class="topHint">
			<img src="images/SFSF.png">
			<p>您可以在此设置各个分组对应的防护策略，或者编辑新增自定义策略包。</p>
			<p>若不进行设置，分组将自动使用火绒为您准备的默认防护策略。</p>
		</div>
		<!-- <div class="commonCon">
            <div class="tab">
                <a class="current" name="tacticsArrange.html" href="tacticsArrange.html">策略部署<a class="" name="tacticsManage.html" href="tacticsManage.html">策略管理<a class="" href="trustZone.html">信任区</a>
            </div>
        </div> -->
		<div class="tabSel">
			<a class="current colorGreen" href="tacticsArrange.html">策略部署
				<a href="tacticsManage.html">策略管理
					<a href="trustZone.html">信任区</a>
		</div>
		<div class="bgContainer">
			<div class="tacticsDescribeTxt floatL">为终端分组部署防护策略个性化处理、保护终端，如果还没有合适的防护策略选择，可以通过新增的方式解决。</div>
			<a class='newTacticsB cursor' onclick='newTacticsPop()'>新建策略</a>
			<div class="clear"></div>
			<div class="tableth">
				<table>
					<tr class='th'>
						<th width='60%' class='th-ordery' type='group_name'>终端分组<img src="images/th-ordery.png" /></th>
						<th width='20%' class='th-ordery' type='clients'>包含终端数<img src="images/th-ordery.png" /></th>
						<th width='20%' class='th-ordery' type='policy_id'>部署防护策略<img src="images/th-ordery.png" /></th>
					</tr>
				</table>
			</div>
			<div class="table tacticsTable">
				<table>
					<tr class='th' id="tableAlign">
						<td width='60%'>终端分组</td>
						<td width='20%'>包含终端数</td>
						<td width='20%'>部署防护策略</td>
					</tr>

				</table>
			</div>
		</div>

	</div>
	<!-- 新建策略弹层 -->
	<div class="newTacticsPop pop">
		<div class="title">新建策略<span class="closeW"></span></div>
		<div class="left"><img src="images/newTac.png"></div>
		<div class="right">
			<p class="input">请选择策略模板&nbsp;<select id="tacticsTem">
					<option>策略模板</option>
				</select></p>
			<p class="input">请输入策略名称&nbsp;<input type="text" id="newTNText"></p>
			<p class="unusualTxt">名称重复，请更改后重试<img src="images/unusual.png"></p>
			<div class="clear"></div>
		</div>
		<div class="clear"></div>
		<div class="buttons">
			<a onclick="hideButton(this)">取消</a>
			<a onclick="submitTN(this)">确定</a>
		</div>
	</div>
	<!-- 新建完成策略后的弹层 -->
	<div class="newTacticsAPop pop">
		<div class="title relative">新建策略成功<span class="closeW"></span></div>
		<div class="left"><img src="images/SFSF.png"></div>
		<div class="right">
			<p>建立策略成功</p>
			<p class="tacticsNameText"><span></span></p>
		</div>
		<div class="clear"></div>
		<div class="buttons">
			<a onclick="hideButton(this)">完成</a>
			<a onclick="editTacticsPop(this)" id="judgePolicyid">编辑策略</a>
		</div>
	</div>
	<!-- 编辑策略弹层 -->
	<div class="checkTacticsPop pop">
		<div class="windowShade absolute"></div>
		<div class="title">
			<font></font><span class="closeW"></span>
		</div>
		<div class="mainBlock">
			<div class="left1 leftScroll">
				<div class="container1">
					<a class="title"><img src="images/basicC.png">常规</a>
					<a class="pageTab">终端升级</a>
					<!-- <a class="pageTab">拓展工具</a> -->
					<a class="title"><img src="images/viC.png">病毒防御</a>
					<a class="pageTab">病毒查杀</a>
					<a class="pageTab">文件实时监控</a>
					<a class="pageTab">恶意行为监控</a>
					<a class="pageTab">U盘保护</a>
					<a class="pageTab">下载保护</a>
					<a class="pageTab">邮件监控</a>
					<a class="title"><img src="images/syC.png">系统防御</a>
					<a class="pageTab">系统加固</a>
					<a class="pageTab">软件安装拦截</a>
					<a class="pageTab">浏览器保护</a>
					<a class="title"><img src="images/neC.png">网络防御</a>
					<a class="pageTab">黑客入侵拦截</a>
					<a class="pageTab">对外攻击检测</a>
					<a class="pageTab">IP协议控制</a>
					<a class="pageTab">恶意网址拦截</a>
					<a class="pageTab">IP黑名单</a>
					<a class="pageTab">设备控制</a>
				</div>

			</div>
			<div class="right">
				<!-- 终端升级 -->
				<div class="page">
					<div class="onOrOff">
						终端升级设置
					</div>
					<div class="setBlock">
						<h4>自动升级</h4>
						<p>
							<input type="checkbox" name="virusUp">
							<span>仅病毒库升级</span>
						</p>

					</div>
					<div class="setBlock lastSetBlock">
						<h4>升级提示</h4>
						<p>
							<input type="checkbox" name="alertTips">
							<span>不弹出升级提示</span>
						</p>
					</div>
				</div>
				<!-- 拓展工具 -->
				<!-- <div class="page">
					<div class="onOrOff">
						拓展工具设置
					</div>
					<div class="setBlock expandToolWrap">
						<h4>启用工具</h4>
						<p class="expandTool">
							<img src="images/cancelC.png"><br />
							<span><input type="checkbox" name="rclickman" />右键管理</span>
						</p>
						<p class="expandTool">
							<img src="images/cancelC.png"><br />
							<span><input type="checkbox" name="sysclean" />垃圾清理</span>
						</p>
						<p class="expandTool">
							<img src="images/cancelC.png"><br />
							<span><input type="checkbox" name="fileshred" />文件粉碎</span>
						</p>
						<p class="expandTool">
							<img src="images/cancelC.png"><br />
							<span><input type="checkbox" name="popblock" />弹窗拦截</span>
						</p>
						<p class="expandTool">
							<img src="images/cancelC.png"><br />
							<span><input type="checkbox" name="autoruns" />启动项管理</span>
						</p>
						<p class="expandTool">
							<img src="images/cancelC.png"><br />
							<span><input type="checkbox" name="netflow" />网络流量</span>
						</p>
						<p class="expandTool">
							<img src="images/cancelC.png"><br />
							<span><input type="checkbox" name="leakrepair" />漏洞修复</span>
						</p>
						<div class="clear"></div>
					</div>

				</div> -->
				<!-- 病毒查杀 -->
				<div class="page">
					<div class="onOrOff">
						病毒查杀设置
					</div>
					<div class="setBlock">
						<h4>开机查杀</h4>
						<p>
							<input type="checkbox" name="startAuto">
							<span>开机自动病毒查杀</span>
						</p>
						<p class="leftP">
							<input type="radio" name="startAutoType" value="0">
							<span>快速查杀</span>
						</p>
						<p class="leftP">
							<input type="radio" name="startAutoType" value="1">
							<span>全盘查杀</span>
						</p>

						<div class="clear"></div>
					</div>
					<div class="setBlock">
						<h4>全盘查杀设置</h4>
						<p>
							<input type="checkbox" name="overallSet1">
							<span>深度查杀压缩包中的病毒木马，并自动跳过大于</span><input type="text" value="" maxlength="4"
								name="overallPara1" onkeyup="value=value.replace(/[^\d]/g,'')"
								onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))">MB的压缩包(20M~9999M)
						</p>
						<p>
							<span>提示：自定义扫描将自动扫描压缩包，并不受以上大小限制</span>
						</p>
						<p class="programPath">
							<input type="checkbox" name="overallSet2">
							<span>不扫描指定扩展名文件</span><input type="text" value="" name="overallPara2"
								class="placeholderInput">
							<span class="placeholder" style="left:172px;">例如：.tmp;.txt;.log;.db</span>
						</p>

					</div>
					<div class="setBlock">
						<h4>查杀速度</h4>
						<p>
							<input type="radio" name="sKSpeed" value="0">
							<span>常规扫描，不影响计算机性能</span>
						</p>
						<p>
							<input type="radio" name="sKSpeed" value="1">
							<span>高速扫描，速度快但影响计算机性能</span>
						</p>

					</div>
					<div class="setBlock">
						<h4>系统修复设置</h4>
						<p>
							<input type="checkbox" name="systemRep">
							<span>快速查杀或全盘查杀的同时扫描系统可修复项目</span>
						</p>
					</div>
					<div class="setBlock">
						<h4>发现病毒时</h4>
						<p class="leftP">
							<input type="radio" name="actionV" value="1">
							<span>终端自主选择</span>
						</p>
						<p class="leftP">
							<input type="radio" name="actionV" value="0">
							<span>自动处理病毒</span>
						</p>
						<div class="clear"></div>

					</div>
					<div class="setBlock lastSetBlock">
						<h4>清除病毒时</h4>
						<p>
							<input type="checkbox" name="backup">
							<span>将病毒文件备份至终端隔离区</span>
						</p>

					</div>

				</div>
				<!-- 文件实时监控 -->
				<div class="page">
					<div class="onOrOff">
						是否开启文件实时监控
						<input type="checkbox" name="fMSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="setBlock">
						<h4>扫描时机</h4>
						<p>
							<input type="radio" name="scanOp" value="0">
							<span>在文件执行时进行扫描,不影响性能（推荐）</span>
						</p>
						<p>
							<input type="radio" name="scanOp" value="1">
							<span>在文件发生变化时进行扫描,将占用少量系统资源</span>
						</p>
						<p>
							<input type="radio" name="scanOp" value="2">
							<span>在文件发生所有类型操作时进行扫描，将占用较多系统资源</span>
						</p>

					</div>
					<div class="setBlock">
						<h4>排除设置</h4>
						<p class="programPath">
							<input type="checkbox" name="debar">
							<span>不扫描指定的程序的动作</span>
							<input type="text" class="programPathTxt placeholderInput" name="debarV">
							<span class="placeholder">例如：C:\Program Files\Test\*.exe;*\test.exe</span>
						</p>

					</div>
					<div class="setBlock">
						<h4>发现病毒时</h4>

						<p class="leftP">
							<input type="radio" name="virusFind" value="1">
							<span>弹窗提示终端自主选择</span>
						</p>
						<p class="leftP">
							<input type="radio" name="virusFind" value="0">
							<span>自动处理</span>
						</p>
						<div class="clear"></div>
					</div>
					<div class="setBlock lastSetBlock">
						<h4>清除病毒时</h4>
						<p>
							<input type="checkbox" name="backupF">
							<span>将病毒文件备份至终端本地隔离区</span>
						</p>

					</div>
				</div>
				<!-- 恶意行为监控 -->
				<div class="page">
					<div class="onOrOff">
						是否开启恶意行为监控
						<input type="checkbox" name="bAMSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="setBlock">
						<h4>发现病毒时</h4>
						<p class="leftP">
							<input type="radio" name="virusFindBAM" value="1">
							<span>弹窗提示终端自主选择</span>
						</p>
						<p class="leftP">
							<input type="radio" name="virusFindBAM" value="0">
							<span>自动处理</span>
						</p>

						<div class="clear"></div>
					</div>
					<div class="setBlock">
						<h4>清除病毒时</h4>
						<p>
							<input type="checkbox" name="backupBAM">
							<span>将病毒文件备份至终端本地隔离区</span>
						</p>

					</div>
					<div class="setBlock lastSetBlock">
						<h4>增强勒索病毒防护</h4>
						<p>
							<input type="checkbox" name="blackMailBAM">
							<span>开启勒索病毒诱捕</span>
						</p>
					</div>
				</div>
				<!-- U盘保护 -->
				<div class="page">
					<div class="onOrOff">
						是否开启U盘保护
						<input type="checkbox" name="uPSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>

					<div class="setBlock">
						<h4>当U盘接入电脑时</h4>
						<p>
							<input type="checkbox" name="cutIn1">
							<span>自动扫描被病毒修改的项目</span>
						</p>
						<p>
							<input type="checkbox" name="cutIn2">
							<span>自动扫描根目录下的文件</span>
						</p>

					</div>
					<div class="setBlock">
						<h4>发现病毒时</h4>
						<p class="leftP">
							<input type="radio" name="virusFindUP" value="1">
							<span>弹窗提示终端自主选择</span>
						</p>
						<p class="leftP">
							<input type="radio" name="virusFindUP" value="0">
							<span>自动处理</span>
						</p>

						<div class="clear"></div>
					</div>
					<div class="setBlock">
						<h4>清除病毒时</h4>
						<p>
							<input type="checkbox" name="backupUP">
							<span>将病毒文件备份至终端本地隔离区</span>
						</p>

					</div>
					<div class="setBlock lastSetBlock">
						<h4>压缩包扫描设置</h4>
						<p>
							<input type="checkbox" name="zipSet">
							<span>深度查杀压缩包中的病毒木马，并自动跳过大于
								<input type="text" name="zipSetV" style="width:50px" maxlength="4"
									onkeyup="value=value.replace(/[^\d]/g,'')"
									onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))">MB的压缩包(20M~9999M)
							</span>
						</p>

					</div>
				</div>
				<!-- 下载保护 -->
				<div class="page">
					<div class="onOrOff">
						是否开启下载保护
						<input type="checkbox" name="dPSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="setBlock">
						<h4>发现病毒时</h4>
						<p class="leftP">
							<input type="radio" name="virusFindDP" value="1">
							<span>弹窗提示终端自主选择</span>
						</p>
						<p class="leftP">
							<input type="radio" name="virusFindDP" value="0">
							<span>自动处理</span>
						</p>

						<div class="clear"></div>
					</div>
					<div class="setBlock">
						<h4>清除病毒时</h4>
						<p>
							<input type="checkbox" name="backupDP">
							<span>将病毒文件备份至终端本地隔离区</span>
						</p>

					</div>
					<div class="setBlock">
						<h4>压缩包扫描设置</h4>
						<p>
							<input type="checkbox" name="zipSetDP">
							<span>
								深度查杀压缩包中的病毒木马，并自动跳过大于 <input type="text" maxlength="4" name="zipSetDPV"
									onkeyup="value=value.replace(/[^\d]/g,'')" style="width:50px"
									onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))">MB的压缩包(20M~9999M)
							</span>
						</p>

					</div>
					<div class="setBlock lastSetBlock">
						<h4>排除设置</h4>
						<p class="programPath">
							<input type="checkbox" name="debarDP">
							<span>不扫描指定扩展名文件</span>
							<input type="text" class="programPathTxt placeholderInput" name="debarDPV">
							<span class="placeholder" style="left:172px;">例如：.tmp;.txt;.log;.db</span>
						</p>

					</div>
				</div>
				<!-- 邮件监控 -->
				<div class="page">
					<div class="onOrOff">
						是否开启邮件监控
						<input type="checkbox" name="mMSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="mailSetText">邮件设置</div>
					<div class="setBlock">
						<h4>清除病毒时</h4>
						<p>
							<input type="checkbox" name="backupMM">
							<span>将病毒文件备份至隔离区</span>
						</p>

					</div>
					<div class="setBlock">
						<h4>邮件扫描</h4>
						<p>
							<span>
								查杀邮件中的病毒木马，并自动跳过大于 <input type="text" maxlength="2" name="zipSetMMV"
									onkeyup="value=value.replace(/[^\d]/g,'')"
									onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))">MB的邮件(1M~20M)
							</span>
						</p>

					</div>
					<div class="mMTableTitle">
						<div class="floatL">邮件规则</div>
						<div class="floatR">
							<a class="deleteMRB" onclick="deleteSMRB(this)">删除所选</a>
							<a class="underline greenfont cursor" onclick="addMRB()">添加规则</a>
						</div>
						<div class="clear"></div>
					</div>
					<div class="mailMTable">
						<table>

						</table>

					</div>
				</div>
				<!-- 系统加固 -->
				<div class="page">
					<div class="onOrOff">
						是否开启系统加固
						<input type="checkbox" name="sRSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="setBlock">
						<h4>自动处理</h4>
						<p>
							<input type="checkbox" name="autoHandle">
							<span>启用火绒自动处理规则</span>
						</p>

					</div>
					<div class="systemRooting">
						<div class="tr">
							<div class="td td1 relative">
								<img src="images/file.png" class="verticalMiddle">
								<div class="absolute">
									<p>文件保护</p>
									<p>防止指定文件项目被篡改，破坏或恶意创建</p>
								</div>
							</div>
							<div class="td td2">已开启9项</div>
							<div class="td td3">
								<a class="cursor deploypng"></a>
							</div>
							<div class="clear"></div>

						</div>
						<table id="filePTable">

						</table>
						<div class="tr">
							<div class="td td1 relative">
								<img src="images/reg.png" class="verticalMiddle">
								<div class="absolute">
									<p>注册表保护</p>
									<p>防止指定文件项目被篡改，破坏或恶意创建</p>
								</div>
							</div>
							<div class="td td2">已开启9项</div>
							<div class="td td3">
								<a class="cursor deploypng"></a>
							</div>
							<div class="clear"></div>

						</div>
						<table id="registryPTable">

						</table>
						<div class="tr">
							<div class="td td1 relative">
								<img src="images/move.png" class="verticalMiddle">
								<div class="absolute">
									<p>危险动作拦截</p>
									<p>监控针对系统的敏感动作，拦截高风险动作</p>
								</div>
							</div>
							<div class="td td2">已开启9项</div>
							<div class="td td3">
								<a class="cursor deploypng"></a>
							</div>
							<div class="clear"></div>

						</div>
						<table id="actionITable">

						</table>
						<div class="tr">
							<div class="td td1 relative">
								<img src="images/exe.png" class="verticalMiddle">
								<div class="absolute">
									<p>执行防护</p>
									<p>防止指定文件项目被篡改，破坏或恶意创建</p>
								</div>
							</div>
							<div class="td td2">已开启9项</div>
							<div class="td td3">
								<a class="cursor deploypng"></a>
							</div>
							<div class="clear"></div>

						</div>
						<table id="executeDTable">

						</table>
						<div class="tr">
							<div class="td td1 relative">
								<img src="images/Process.png" class="verticalMiddle">
								<div class="absolute">
									<p>进程保护</p>
									<p>实时保护系统重要进程，使其不被攻击利用</p>
								</div>
							</div>
							<div class="td td2">已开启9项</div>
							<div class="td td3">
								<a class="cursor deploypng"></a>
							</div>
							<div class="clear"></div>

						</div>
						<table id="processPTable">

						</table>
						<div class="tr">
							<div class="td td1 relative">
								<img src="images/ant.png" class="verticalMiddle">
								<div class="absolute">
									<p>病毒免疫</p>
									<p>防止指定文件项目被篡改，破坏或恶意创建</p>
								</div>
							</div>
							<div class="td td2">已开启9项</div>
							<div class="td td3">
								<a class="cursor deploypng"></a>
							</div>
							<div class="clear"></div>

						</div>
						<table id="virusITable">

						</table>
					</div>
				</div>

				<!-- 软件安装拦截 -->
				<div class="page">
					<div class="onOrOff">
						是否开启软件安装拦截
						<input type="checkbox" name="sISwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="title">
						软件安装拦截模式
					</div>
					<div class="actionSelect lastActionSelect">
						<ul>
							<li>
								<input type="radio" name="actionII" value="0">常规模式 : 弹窗提示终端自助选择(推荐)

							</li>
							<li>
								<input type="radio" name="actionII" value="1">严格模式 : 自动阻止所有推广软件安装行为

							</li>
						</ul>

					</div>
					<!-- <div class="setBlock lastSetBlock">
                                        <h4>排除设置</h4>
                                        <p class="programPath">
                                                <input type="checkbox" name="debarII">
                                                <span>不扫描指定的程序的动作</span>
                                                <input type="text" class="programPathTxt placeholderInput" name="debarIIV">
                                                <span class="placeholder">例如：C:\Program Files\Test\*.exe;*\test.exe</span>
                                        </p>

                                </div> -->
				</div>
				<!-- 浏览器保护 -->
				<div class="page">
					<div class="onOrOff">
						是否开启浏览器主页保护
						<input type="checkbox" name="bPSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="title">
						锁定浏览器主页
					</div>
					<div class="actionSelect lastActionSelect">
						<ul>
							<li>
								<input type="radio" name="startpage" value="0">空白页

							</li>
							<li>
								<input type="radio" name="startpage" value="1">自定义:<input type="text" class="path"
									name="webpage">

							</li>
						</ul>

					</div>
				</div>
				<!-- 黑客入侵拦截 -->
				<div class="page">
					<div class="onOrOff">
						是否开启黑客入侵拦截
						<input type="checkbox" name="hISwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="title">
						黑客入侵拦截
					</div>
					<div class="actionSelect lastActionSelect">
						<ul>
							<li>
								<input type="radio" name="actionHI" value="0">自动阻止入侵行为

							</li>
							<li>
								<input type="radio" name="actionHI" value="1">仅记录入侵行为

							</li>
						</ul>

					</div>

				</div>
				<!-- 对外攻击检测 -->
				<div class="page">
					<div class="onOrOff">
						是否开启对外攻击检测
						<input type="checkbox" name="aCSwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="title">
						对外攻击检测
					</div>
					<div class="actionSelect lastActionSelect">
						<ul>
							<li>
								<input type="radio" name="actionAC" value="0">自动阻止攻击行为

							</li>
							<li>
								<input type="radio" name="actionAC" value="1">仅记录攻击行为

							</li>
						</ul>
					</div>
				</div>
				<!-- IP控制协议 -->
				<div class="page">
					<div class="onOrOff">
						是否开启IP协议控制
						<input type="checkbox" name="pCSwitch" value="" class="lcs_check" autocomplete="off" />
						<div class="switchShade absolute">
						</div>

					</div>

					<div class="bLTableTitle">
						<div class="floatL">
							<a class="deleteMRB underline" onclick="deleteSMRB(this)">删除所选</a>
						</div>
						<div class="floatR">
							<!-- <input type="checkbox" name="" value="" class="verticalMiddle"><span class="verticalMiddle">&nbsp;显示内置规则</span> -->
							<a class="underline greenfont cursor" onclick="addPCB()">添加规则</a>
						</div>
						<div class="clear"></div>
					</div>
					<div class="protocolCTable">
						<table>
							<tr>
								<th width='10%'><input type='checkbox' onclick='selectAllFP(this)'
										class='verticalMiddle'></th>
								<th width='15%'>规则名</th>
								<th width='50%'>说明</th>
								<th width='10%'>启用</th>
								<th width='15%'>操作</th>
							</tr>
						</table>

					</div>
				</div>
				<!-- 恶意网址拦截 -->
				<div class="page">
					<div class="onOrOff">
						是否开启恶意网站拦截
						<input type="checkbox" name="wISwitch" value="" class="lcs_check" autocomplete="off" />

					</div>
					<div class="describe">
						<p>恶意网址拦截</p>
						<p>将自动识别存在恶意风险的网站，阻止终端访问这些恶意网站</p>
					</div>
					<div class="webRule">
						<ul>
							<p class="li titlee">恶意网址规则
							</p>
							<p class="li">木马、盗号
								<input type="checkbox" name="spy" value="" class="lcs_check" autocomplete="off" />

							</p>
							<p class="li">虚假、欺诈
								<input type="checkbox" name="fraud" value="" class="lcs_check" autocomplete="off" />

							</p>
							<p class="li">钓鱼、仿冒
								<input type="checkbox" name="phising" value="" class="lcs_check" autocomplete="off" />

							</p>
						</ul>

					</div>
				</div>
				<!-- IP黑名单 -->
				<div class="page">
					<div class="onOrOff">
						是否开启IP黑名单功能
						<input type="checkbox" name="bLSwitch" value="" class="lcs_check" autocomplete="off" />
						<div class="switchShade absolute">
						</div>

					</div>

					<div class="bLTableTitle">
						<div class="floatL">
							<a class="deleteMRB underline" onclick="deleteSMRB(this)">删除所选</a>
						</div>
						<div class="floatR">
							<a class="underline greenfont cursor" onclick="addBLB()">添加规则</a>
						</div>
						<div class="clear"></div>
					</div>
					<div class="blackLTable">
						<table>

						</table>

					</div>
				</div>
				<!-- 设备控制 -->
				<div class="page">
					<div class="onOrOff">
						是否开启设备控制
						<input type="checkbox" name="devSwitch" value="" class="lcs_check" autocomplete="off" />
						<div class="switchShade absolute">
						</div>

					</div>
					<div class="setBlock lastSetBlock" style="padding: 0;padding-left: 20px;">
						<p style="height: 40px;line-height: 40px;">
							<input type="checkbox" name="tipsHide">
							<span>设备禁用时弹窗提示</span>
						</p>

					</div>
					<div class="webRule" style="height: auto;border: 0;">
						<ul>
							<p class="li titlee" style="height: 40px;line-height: 40px;">设备
								<span
									style="display: inline-block;position: absolute;right: 58px;line-height: 40px;height: 40px;vertical-align: middle;">状态</span>
							</p>

							<p class="li relative">U盘设备
								<input type="checkbox" name="udisk" value="" class="lcs_check" autocomplete="off" />
								<span class="switchShade absolute">
								</span>

							</p>
							<p class="li relative">便携设备
								<input type="checkbox" name="portable" value="" class="lcs_check" autocomplete="off" />
								<span class="switchShade absolute">
								</span>

							</p>
							<p class="li relative">USB无线网卡
								<input type="checkbox" name="usb-wifi" value="" class="lcs_check" autocomplete="off" />
								<span class="switchShade absolute">
								</span>

							</p>
							<p class="li relative">USB有线网卡
								<input type="checkbox" name="usb-netcard" value="" class="lcs_check"
									autocomplete="off" />
								<span class="switchShade absolute">
								</span>

							</p>
							<p class="li relative">打印机
								<input type="checkbox" name="printer" value="" class="lcs_check" autocomplete="off" />
								<span class="switchShade absolute">
								</span>

							</p>
							<p class="li relative">光驱
								<input type="checkbox" name="cdrom" value="" class="lcs_check" autocomplete="off" />
								<span class="switchShade absolute">
								</span>

							</p>
							<p class="li relative">蓝牙
								<input type="checkbox" name="bluetooth" value="" class="lcs_check" autocomplete="off" />
								<span class="switchShade absolute">
								</span>

							</p>
						</ul>

					</div>

				</div>
				<!-- <a class="defaultButton">恢复默认设置</a>
                    <a class="saveButton">保存</a><a class="cancellButton">取消</a> -->
			</div>
			<div class="clear"></div>
		</div>
		<div class="addBLPop absolute hidden windowPop">
			<div class="title">
				<font>IP黑名单</font>
				<span class="closeWW"></span>
			</div>
			<div class="content">
				<p>
					<label>远程IP : </label>
					<select>
						<option value="0">单个IP</option>
						<option value="1">多个IP</option>
					</select>
				</p>
				<p>
					<label></label>
					<input type="text" name="" class="ip">
					<span class="hidden">
						-
						<input type="text" name="" class="ip">
					</span>
				</p>
				<p>
					<label>备注 : </label>
					<input type="text" name="" class="remark">
				</p>

			</div>
			<div class="buttons">
				<a onclick="hideButtonn(this)">取消</a>
				<a onclick="sureAddBLB(this)">保存</a>

				<div class="clear"></div>
			</div>
		</div>
		<div class="editBLPop absolute hidden windowPop">
			<div class="title">
				<font>IP黑名单</font>
				<span class="closeWW"></span>
			</div>
			<div class="content">
				<p>
					<label>远程IP : </label>
					<select>
						<option value="0">单个IP</option>
						<option value="1">多个IP</option>
					</select>
				</p>
				<p>
					<label></label>
					<input type="text" name="" class="ip">
					<span class="hidden">
						-
						<input type="text" name="" class="ip">
					</span>
				</p>
				<p>
					<label>备注 : </label>
					<input type="text" name="" class="remark">
				</p>

			</div>
			<div class="buttons">
				<a onclick="hideButtonn(this)">取消</a>
				<a onclick="sureEditBLB(this)">保存</a>

				<div class="clear"></div>
			</div>
		</div>
		<div class="addPCPop absolute hidden windowPop">
			<div class="title">
				<font>网络协议控制</font>
				<span class="closeWW"></span>
			</div>
			<div class="content">
				<p>
					<label>规则名 : </label>
					<input type="text" name="ruleName" value="" placeholder="" maxlength="10">
				</p>
				<p>
					<label>操作 : </label>
					<select class="ope">
						<option value="0">放行</option>
						<option value="1">阻止</option>}
					</select>
				</p>
				<p>
					<label>方向 : </label>
					<select class="dir">
						<option value="0">所有</option>
						<option value="1">入站</option>
						<option value="2">出站</option>
					</select>

				</p>
				<p>
					<label>协议 : </label>
					<select class="pro">
						<option value="1">ICMP</option>
						<option value="2">IGMP</option>
						<option value="3">GGP</option>
						<option value="260">TCP/UDP</option>
						<option value="6" selected>TCP</option>
						<option value="17">UDP</option>
						<option value="12">PUP</option>
						<option value="22">IDP</option>
						<option value="77">ND</option>
						<option value="50">ESP</option>
						<option value="51">AH</option>
						<option value="47">GRE</option>
						<option value="27">RDP</option>
						<option value="57">SKIP</option>
						<option value="255">RAW</option>

					</select>
					<select class="ICMP hidden">
						<option value="0">0-回显响应</option>
						<option value="3">3-目标无法到达</option>
						<option value="4">4-源抑制</option>
						<option value="5">5-重定向</option>
						<option value="8">8-回显请求（PING请求）</option>
						<option value="9">9-路由器通知</option>
						<option value="10">10-路由器请求</option>
						<option value="11">11-数据包超时</option>
						<option value="12">12-数据包参数存在问题</option>
						<option value="13">13-时间戳请求</option>
						<option value="14">14-时间戳应答</option>
						<option value="15">15-信息请求</option>
						<option value="16">16-信息回复</option>
						<option value="17">17-地址掩码请求</option>
						<option value="18">18-地址掩码应答</option>

					</select>

				</p>
				<p class="relative">
					<label>本地IP : </label>
					<select class="ipports localip">
						<option value="0">任意IP</option>
						<option value="1">自定义</option>}
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden localipv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>IP地址或子网的列表:</font><br>
						多个条目必须以英文逗号分隔<br>
						例如:192.168.1.5,10.1.0.25-10.1.0.99
					</span>
				</p>
				<p class="relative">
					<label>本地端口 : </label>
					<select class="ipports localport">
						<option value="0">任意端口</option>
						<option value="1">自定义</option>
						<option value="3" class="hidden">无</option>
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden localportv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>端口活动范围列表</font><br>
						多个条目必须以英文逗号分隔 <br>
						例如80,443,1000-2000,40000-65535
					</span>
				</p>
				<p class="relative">
					<label>远程IP : </label>
					<select class="ipports remoteip">
						<option value="0">任意IP</option>
						<option value="1">自定义</option>
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden remoteipv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>IP地址或子网的列表:</font><br>
						多个条目必须以英文逗号分隔<br>
						例如:192.168.1.5,10.1.0.25-10.1.0.99
					</span>
				</p>
				<p class="relative">
					<label>远程端口 : </label>
					<select class="ipports remoteport">
						<option value="0">任意端口</option>
						<option value="1">自定义</option>
						<option value="3" class="hidden">无</option>
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden remoteportv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>端口活动范围列表</font><br>
						多个条目必须以英文逗号分隔 <br>
						例如80,443,1000-2000,40000-65535
					</span>
				</p>

			</div>
			<div class="buttons">
				<a onclick="hideButtonn(this)">取消</a>
				<a onclick="sureAddPCB(this)">保存</a>

				<div class="clear"></div>
			</div>
		</div>
		<div class="editPCPop absolute hidden windowPop">
			<div class="title">
				<font>网络协议控制</font>
				<span class="closeWW"></span>
			</div>
			<div class="content">
				<p>
					<label>规则名 : </label>
					<input type="text" name="ruleName" value="" placeholder="" maxlength="10">
				</p>
				<p>
					<label>操作 : </label>
					<select class="ope">
						<option value="0">放行</option>
						<option value="1">阻止</option>}
					</select>
				</p>
				<p>
					<label>方向 : </label>
					<select class="dir">
						<option value="0">所有</option>
						<option value="1">入站</option>
						<option value="2">出站</option>
					</select>

				</p>
				<p>
					<label>协议 : </label>
					<select class="pro">
						<option value="1">ICMP</option>
						<option value="2">IGMP</option>
						<option value="3">GGP</option>
						<option value="260">TCP/UDP</option>
						<option value="6" selected>TCP</option>
						<option value="17">UDP</option>
						<option value="12">PUP</option>
						<option value="22">IDP</option>
						<option value="77">ND</option>
						<option value="50">ESP</option>
						<option value="51">AH</option>
						<option value="47">GRE</option>
						<option value="27">RDP</option>
						<option value="57">SKIP</option>
						<option value="255">RAW</option>

					</select>
					<select class="ICMP hidden">
						<option value="0">0-回显响应</option>
						<option value="3">3-目标无法到达</option>
						<option value="4">4-源抑制</option>
						<option value="5">5-重定向</option>
						<option value="8">8-回显请求（PING请求）</option>
						<option value="9">9-路由器通知</option>
						<option value="10">10-路由器请求</option>
						<option value="11">11-数据包超时</option>
						<option value="12">12-数据包参数存在问题</option>
						<option value="13">13-时间戳请求</option>
						<option value="14">14-时间戳应答</option>
						<option value="15">15-信息请求</option>
						<option value="16">16-信息回复</option>
						<option value="17">17-地址掩码请求</option>
						<option value="18">18-地址掩码应答</option>

					</select>

				</p>
				<p class="relative">
					<label>本地IP : </label>
					<select class="ipports localip">
						<option value="0">任意IP</option>
						<option value="1">自定义</option>}
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden localipv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>IP地址或子网的列表:</font><br>
						多个条目必须以英文逗号分隔<br>
						例如:192.168.1.5,10.1.0.25-10.1.0.99
					</span>
				</p>
				<p class="relative">
					<label>本地端口 : </label>
					<select class="ipports localport">
						<option value="0">任意端口</option>
						<option value="1">自定义</option>
						<option value="3" class="hidden">无</option>
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden localportv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>端口活动范围列表</font><br>
						多个条目必须以英文逗号分隔 <br>
						例如80,443,1000-2000,40000-65535
					</span>
				</p>
				<p class="relative">
					<label>远程IP : </label>
					<select class="ipports remoteip">
						<option value="0">任意IP</option>
						<option value="1">自定义</option>
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden remoteipv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>IP地址或子网的列表:</font><br>
						多个条目必须以英文逗号分隔<br>
						例如:192.168.1.5,10.1.0.25-10.1.0.99
					</span>
				</p>
				<p class="relative">
					<label>远程端口 : </label>
					<select class="ipports remoteport">
						<option value="0">任意端口</option>
						<option value="1">自定义</option>
						<option value="3" class="hidden">无</option>
					</select>
					<input type="text" name="" value="" placeholder="" class="hidden remoteportv">
					<img src="images/unusual.png" alt="" class="verticalMiddle hintIco cursor hidden">
					<span class="absolute floatHint hidden">
						<font>端口活动范围列表</font><br>
						多个条目必须以英文逗号分隔 <br>
						例如80,443,1000-2000,40000-65535
					</span>
				</p>

			</div>
			<div class="buttons">
				<a onclick="hideButtonn(this)">取消</a>
				<a onclick="sureEditPCB(this)">保存</a>

				<div class="clear"></div>
			</div>
		</div>
		<div class="buttons">
			<a onclick="hideButton(this)">取消</a>
			<a onclick="sureEditButton(this)">保存</a>

			<div class="clear"></div>
		</div>
	</div>
	<div class="shade"></div>
	<div class="delayHide">
		<p class="p1"><img src="images/unusualw.png">请选择终端!</p>
		<!-- <p class="p2">(<font>3秒后</font>本窗口消失，任务将在后台继续完成下发)</p> -->
	</div>
	<div class="delayHideS">
		<p class="p1"></p>
	</div>
	<script>
		//策略开关样式
		$(document).ready(function (e) {
			$('.lcs_check').lc_switch();
		});
		// loading执行
		//后退到当前页面将父页面选项卡置为当前位置
		parent.$(".nav .container a[name='tacticsArrange.html']").addClass("current");
		parent.$(".nav .container a[name='tacticsArrange.html']").siblings().removeClass("current");
		parent.$(".footer").show();
		var date = new Date();
		date.setTime(date.getTime() + 100 * 365 * 24 * 60 * 60 * 1000);
		document.cookie = 'page=tacticsArrange.html';
		//获取策略列表
		policylist();
		var select = "";

		function policylist() {
			$.ajax({
				url: '/mgr/policy/_list',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {
					var list = data.data.list;

					for (i = 0; i < list.length; i++) {

						select += "<option policyid=" + list[i].policy_id + ">" + safeStr(list[i].policy_name) +
							"</option>";

					}

				}
			})
		}


		//分组部署策略列表
		setTimeout(function () {
			tacticsArrange();
		}, 100)

		//全选
		function selectAllFP(checkbox) {
			$(checkbox).parents("table").find('.selectFP').prop('checked', $(checkbox).prop('checked'));
		}
		//新建策略input限制
		$("#newTNText").keyup(function () {
			if ($(this).val().length > 40) {
				$(this).val($(this).val().substr(0, 40));
			}
		})
		//端口号正则数字限制 数字范围限制
		$(".mailMTable").on("keyup", ".portInput", function () {
			var value = $(this).val();
			value = value.replace(/[^\d]/g, '');
			$(this).val(value);

			if ($(this).val() > 65535) {
				$(this).val(65535);
			}
		})
		// 
		$("input[name=overallPara1],input[name=zipSetV],input[name=zipSetDPV],input[name=zipSetMMV]").keyup(function () {
			var value = $(this).val();
			value = parseInt(value.replace(/[^\d]/g, ''));
			if (isNaN(value)) {

			} else {
				$(this).val(parseInt(value));
			}
		})
		//编辑策略中多选框或单选框点选变化引起后面文本框变化
		$("input[type=checkbox]").change(function () {
			if ($(this).is(":checked")) {
				$(this).parent().find("input[type=text]").prop("disabled", false);
				if ($(this).parent().find("input[type=text]").val() == '') {
					$(this).parent().find(".placeholder").show();
				} else {
					$(this).parent().find(".placeholder").hide();
				}
			} else {
				$(this).parent().find("input[type=text]").prop("disabled", true);
				$(this).parent().find(".placeholder").hide();
			}
		})
		$("input[name=startpage]").click(function () {
			if ($(this).val() == 0) {
				$(this).parent().siblings().find("input[type=text]").prop("disabled", true)
			} else {
				$(this).parent().find("input[type=text]").prop("disabled", false)
			}
		})
		//点击左边切换显示右边内容
		$(".pageTab").click(function () {

			var index = $(this).index(".pageTab");
			$(this).siblings(".pageTab").removeClass("current");
			$(this).addClass("current");
			$(".mainBlock .right").children(".page").hide();
			$(".mainBlock .right").children(".page").eq(index).show();

		})
		//系统加固展开列表
		$(".systemRooting .tr").mouseenter(function () {
			$(this).find(".deploypng").css({
				backgroundPosition: "-18px"
			})
		})
		$(".systemRooting .tr").mouseleave(function () {
			$(this).find(".deploypng").css({
				backgroundPosition: "0px"
			})
		})
		$(".systemRooting .tr").click(function () {
			if ($(this).next().is(":hidden")) {
				$(this).next().show();
				$(this).find(".deploypng").css({
					background: "url(../images/task2.png)",
					backgroundPosition: "-18px"
				})
			} else {
				$(this).next().hide();
				$(this).find(".deploypng").css({
					background: "url(../images/task1.png)",
					backgroundPosition: "-18px"
				})
			}
		})
		//排序

		$(document).on('click', '.tableth th.th-ordery', function () {
			var toggleClass = $(this).attr('class');
			$(this).siblings('th.th-ordery').removeClass().addClass('th-ordery');
			$(this).siblings('th.th-ordery').find('img').attr('src', 'images/th-ordery.png');

			if (toggleClass == 'th-ordery') {
				$(this).find('img').attr('src', 'images/th-ordery-up.png');
				$(this).addClass('th-ordery-current th-ordery-up');
			} else if (toggleClass == 'th-ordery th-ordery-current th-ordery-up') {
				$(this).find('img').attr('src', 'images/th-ordery-down.png');
				$(this).addClass('th-ordery-current th-ordery-down');

			} else if (toggleClass == 'th-ordery th-ordery-current th-ordery-up th-ordery-down') {
				$(this).find('img').attr('src', 'images/th-ordery.png');
				$(this).removeClass('th-ordery-current th-ordery-down th-ordery-up');
			}
			tacticsArrange();
		})
		// 策略部署
		function tacticsArrange() {
			$(".table table #tableAlign").siblings('tr').html('');
			var dataa = {};
			var type = $('.tableth th.th-ordery.th-ordery-current').attr('type');
			var orderClass = $('.tableth th.th-ordery.th-ordery-current').attr('class');
			var ordery;
			var order = {};
			dataa.order = [];
			if (orderClass == 'th-ordery th-ordery-current th-ordery-up th-ordery-down') {
				ordery = 'desc';
			} else if (orderClass == 'th-ordery th-ordery-current th-ordery-up') {
				ordery = 'asc';
			}
			if (type) {
				order[type] = ordery;
				dataa.order.push(order);
			}


			$.ajax({
				url: '/mgr/group/_list',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {
					var list = data.data.list;
					var tableth = "";
					tableth += "<tr groupid=" + data.data.ungrouped.group_id + ">";
					tableth += "<td><img src='images/computer1.png'>未分组终端</td>";
					tableth += "<td>" + data.data.ungrouped.clients + "</td>";
					tableth += "<td>";
					tableth += "<select onclick='getGroupId(this)' onchange='changeGT()' disabled='true'>";
					tableth += select;
					tableth += "</select>";
					tableth += "</td>";
					tableth += "</tr>";
					$(".bgContainer .table table").append(tableth);
					$("tr[groupid=" + data.data.ungrouped.group_id + "] select option[policyid=" + data.data
						.ungrouped.policy_id + "]").attr("selected", true);

					for (i = 0; i < list.length; i++) {
						var groupid = list[i].group_id;
						var grouppolicyid = list[i].policy_id;
						var table = "";
						table += "<tr groupid=" + list[i].group_id + ">";
						table += "<td><img src='images/computer11.png'><span>" + safeStr(list[i].group_name) +
							"</span></td>";
						table += "<td>" + list[i].clients + "</td>";
						table += "<td>";
						table += "<select onclick='getGroupId(this)' onchange='changeGT()'>";
						table += select;
						table += "</select>";
						table += "</td>";
						table += "</tr>";

						$(".bgContainer .table table").append(table);
						$("tr[groupid=" + groupid + "] select option[policyid=" + grouppolicyid + "]").attr(
							"selected", true);
					}


				}
			})

		}
		var groupid = "";

		function getGroupId(a) {
			groupid = parseInt($(a).parents("tr").attr("groupid"));
		}

		function changeGT() {

			var policyid = parseInt($("tr[groupid=" + groupid + "] select option:selected").attr("policyid"));

			var dataa = {
				"group_id": groupid,
				"policy_id": policyid
			};
			$.ajax({
				url: '/mgr/policy/_assign',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {

				}
			})
		}
		//关闭弹层
		$(".closeW").click(function () {
			$(".shade").hide();
			parent.$(".topshade").hide();
			$(this).parent().parent().hide();
		});
		$(".closeWW").click(function () {
			$(".windowShade").hide();
			$(this).parent().parent().hide();
		});
		//关闭遮罩和弹窗
		function hideButton(a) {
			$(".shade").hide();
			parent.$(".topshade").hide();
			$(a).parents(".pop").hide();
		}

		function hideButtonn(a) {
			$(".windowShade").hide();
			$(a).parent().parent().hide();
		}
		//弹出新建策略弹层
		function newTacticsPop() {
			shade();
			$("#newTNText").val("");
			$(".newTacticsPop").show();
			$(".newTacticsPop .right .unusualTxt").hide();
			$(".newTacticsPop .placeholder").show();
			// 读取现有的策略
			$.ajax({
				url: '/mgr/policy/_list',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {
					var list = data.data.list;
					var html = "";
					html += "<option value=" + list[list.length - 1].policy_id + ">" + safeStr(list[list.length -
						1].policy_name) + "</option>";
					for (i = 0; i < list.length - 1; i++) {
						html += "<option value=" + list[i].policy_id + ">" + safeStr(list[i].policy_name) +
							"</option>";
					}

					$(".newTacticsPop #tacticsTem").html(html);
				}
			})
		}

		function submitTN(a) {
			var newTNText = trim($("#newTNText").val());
			var dataa = {
				"policy_name": newTNText
			};
			if (newTNText.length == 0) {
				$(".newTacticsPop .right .unusualTxt").show();
				$(".newTacticsPop .right .unusualTxt").html("策略名称不能为空<img src='images/unusual.png'>");

			} else {
				$.ajax({
					url: '/mgr/policy/_create',
					data: JSON.stringify(dataa),
					type: 'POST',
					contentType: 'text/plain',
					headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
					error: function (xhr, textStatus, errorThrown) {
						if (xhr.status == 401) {
							parent.window.location.href = '/';
						} else {

						}

					},
					success: function (data) {

						if (data.errno == -1 && data.errmsg.indexOf("1062") > 0) {
							$(".newTacticsPop .right .unusualTxt").show();
							$(".newTacticsPop .right .unusualTxt").html(
								"已存在相同策略名,创建策略失败<img src='images/unusual.png'>");
						} else {
							var newtacticsid = data.data.policy_id; //新建策略成功后的策略id
							// 新建策略成功提示
							$(".delayHideS").show();
							$(".delayHideS .p1").html(
								"<img src='images/success.png' class='verticalMiddle'><span class='verticalMiddle'> 新建成功</span>"
							);
							setTimeout(function () {
								$(".delayHideS").hide()
							}, 2000);

							$(".bgContainer .table table").html(
								"<tr class='th' id='tableAlign'><td width='60%'>终端分组</td><td width='20%'>包含终端数</td><td width='20%'>部署防护策略</td></tr>"
							);
							select = "";
							policylist();
							setTimeout(function () {
								tacticsArrange();
							}, 100)
							$(a).parents(".pop").hide();
							$(".newTacticsAPop").show();
							$(".newTacticsAPop .tacticsNameText span").html(
								"<font class='verticalMiddle'>策略名称:</font><font class='name'>" + safeStr(data
									.data.policy_name) + "</font>");
							$(".newTacticsAPop .tacticsNameText span").attr("policyid", data.data.policy_id);
							$(".newTacticsAPop .tacticsNameText span").attr("policyname", data.data.policy_name);
							// 获取所选模板的策略配置并更新新建策略的配置
							var tempolicyid = parseInt($(".newTacticsPop #tacticsTem").val());
							//检测所有开关状态
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=power',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								error: function (xhr, textStatus, errorThrown) {
									if (xhr.status == 401) {
										parent.window.location.href = '/';
									} else {

									}

								},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "power",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});

							// 病毒查杀
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=scan',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								error: function (xhr, textStatus, errorThrown) {
									if (xhr.status == 401) {
										parent.window.location.href = '/';
									} else {

									}

								},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "scan",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										success: function (data) {

										}
									});
								}
							});
							// 文件实时监控
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=filemon',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								error: function (xhr, textStatus, errorThrown) {
									if (xhr.status == 401) {
										parent.window.location.href = '/';
									} else {

									}

								},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "filemon",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							// 恶意行为监控
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=behavior',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								error: function (xhr, textStatus, errorThrown) {
									if (xhr.status == 401) {
										parent.window.location.href = '/';
									} else {

									}

								},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "behavior",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							// U盘保护
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=udiskmon',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "udiskmon",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										success: function (data) {

										}
									});
								}
							});
							//下载保护
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=dlmon',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "dlmon",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										success: function (data) {

										}
									});
								}
							});
							//邮件监控
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=mail',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "mail",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//软件安装拦截
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=instmon',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "instmon",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//浏览器保护
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=browserprot',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "browserprot",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//黑客入侵拦截
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=intrusion',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "intrusion",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});

								}
							});
							//对外攻击检测
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=ipattack',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "ipattack",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//恶意网址拦截
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=malsite',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "malsite",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//系统加固
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=sysprot',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "sysprot",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//ip协议控制
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=ipproto',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "ipproto",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//ip黑名单
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=ipblacklist',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "ipblacklist",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
										success: function (data) {

										}
									});
								}
							});
							//设备控制
							$.ajax({
								url: '/mgr/policy/_info?id=' + tempolicyid + '&fname=devmgr',
								data: {},
								type: 'GET',
								contentType: 'text/plain',
								headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
								success: function (data) {
									var dataa = {
										"policy_id": newtacticsid,
										"fname": "devmgr",
										"config": data.data.data.config
									};
									$.ajax({
										url: '/mgr/policy/_update',
										data: JSON.stringify(dataa),
										type: 'POST',
										contentType: 'text/plain',
										success: function (data) {

										}
									});
								}
							});
						}

					}
				});
			}

		}

		// 弹出编辑策略
		function editTacticsPop(a) {
			$(".newTacticsAPop").hide();
			shade();

			$(".mainBlock .left").find(".pageTab").removeClass("current");
			$(".mainBlock .left").find(".pageTab").eq(0).addClass("current");
			$(".mainBlock .right").children(".page").hide();
			$(".mainBlock .right").children(".page").eq(0).show();
			$(".checkTacticsPop").show();
			if ($(a).attr("id") == "judgePolicyid") {

				policyid = parseInt($(".newTacticsAPop .tacticsNameText span").attr("policyid"));
				$(".checkTacticsPop").children(".title").children("font").html("编辑策略-" + safeStr($(
					".newTacticsAPop .tacticsNameText span").attr("policyname")));

			} else {
				policyid = parseInt($(a).parents("tr").attr("policyid"));
				$(".checkTacticsPop").children(".title").children("font").html("编辑策略-" + safeStr($(a).parents("tr").find("td")
					.eq(0).find("h3").html()));
			}

			//检测所有开关状态
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=power',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {
					if (data.data.data.config.filemon == true) {

						$("input[name=fMSwitch]").prop("checked", true);
						$("input[name=fMSwitch]").next().addClass("lcs_on");
						$("input[name=fMSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=fMSwitch]").prop("checked", false);
						$("input[name=fMSwitch]").next().addClass("lcs_off");
						$("input[name=fMSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.behavior == true) {

						$("input[name=bAMSwitch]").prop("checked", true);
						$("input[name=bAMSwitch]").next().addClass("lcs_on");
						$("input[name=bAMSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=bAMSwitch]").prop("checked", false);
						$("input[name=bAMSwitch]").next().addClass("lcs_off");
						$("input[name=bAMSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.udiskmon == true) {

						$("input[name=uPSwitch]").prop("checked", true);
						$("input[name=uPSwitch]").next().addClass("lcs_on");
						$("input[name=uPSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=uPSwitch]").prop("checked", false);
						$("input[name=uPSwitch]").next().addClass("lcs_off");
						$("input[name=uPSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.dlmon == true) {

						$("input[name=dPSwitch]").prop("checked", true);
						$("input[name=dPSwitch]").next().addClass("lcs_on");
						$("input[name=dPSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=dPSwitch]").prop("checked", false);
						$("input[name=dPSwitch]").next().addClass("lcs_off");
						$("input[name=dPSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.sysprot == true) {

						$("input[name=sRSwitch]").prop("checked", true);
						$("input[name=sRSwitch]").next().addClass("lcs_on");
						$("input[name=sRSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=sRSwitch]").prop("checked", false);
						$("input[name=sRSwitch]").next().addClass("lcs_off");
						$("input[name=sRSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.instmon == true) {

						$("input[name=sISwitch]").prop("checked", true);
						$("input[name=sISwitch]").next().addClass("lcs_on");
						$("input[name=sISwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=sISwitch]").prop("checked", false);
						$("input[name=sISwitch]").next().addClass("lcs_off");
						$("input[name=sISwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.browserprot == true) {

						$("input[name=bPSwitch]").prop("checked", true);
						$("input[name=bPSwitch]").next().addClass("lcs_on");
						$("input[name=bPSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=bPSwitch]").prop("checked", false);
						$("input[name=bPSwitch]").next().addClass("lcs_off");
						$("input[name=bPSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.intrusion == true) {

						$("input[name=hISwitch]").prop("checked", true);
						$("input[name=hISwitch]").next().addClass("lcs_on");
						$("input[name=hISwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=hISwitch]").prop("checked", false);
						$("input[name=hISwitch]").next().addClass("lcs_off");
						$("input[name=hISwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.ipattack == true) {

						$("input[name=aCSwitch]").prop("checked", true);
						$("input[name=aCSwitch]").next().addClass("lcs_on");
						$("input[name=aCSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=aCSwitch]").prop("checked", false);
						$("input[name=aCSwitch]").next().addClass("lcs_off");
						$("input[name=aCSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.malsite == true) {

						$("input[name=wISwitch]").prop("checked", true);
						$("input[name=wISwitch]").next().addClass("lcs_on");
						$("input[name=wISwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=wISwitch]").prop("checked", false);
						$("input[name=wISwitch]").next().addClass("lcs_off");
						$("input[name=wISwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.mail == true) {

						$("input[name=mMSwitch]").prop("checked", true);
						$("input[name=mMSwitch]").next().addClass("lcs_on");
						$("input[name=mMSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=mMSwitch]").prop("checked", false);
						$("input[name=mMSwitch]").next().addClass("lcs_off");
						$("input[name=mMSwitch]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.ipproto == true) {
						$("input[name=pCSwitch]").prop("checked", true);
						$("input[name=pCSwitch]").next().addClass("lcs_on");
						$("input[name=pCSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=pCSwitch]").prop("checked", false);
						$("input[name=pCSwitch]").next().addClass("lcs_off");
						$("input[name=pCSwitch]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.ipblacklist == true) {
						$("input[name=bLSwitch]").prop("checked", true);
						$("input[name=bLSwitch]").next().addClass("lcs_on");
						$("input[name=bLSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=bLSwitch]").prop("checked", false);
						$("input[name=bLSwitch]").next().addClass("lcs_off");
						$("input[name=bLSwitch]").next().removeClass("lcs_on");
					}

					if (data.data.data.config.devmgr == true) {
						$("input[name=devSwitch]").prop("checked", true);
						$("input[name=devSwitch]").next().addClass("lcs_on");
						$("input[name=devSwitch]").next().removeClass("lcs_off");
					} else {
						$("input[name=devSwitch]").prop("checked", false);
						$("input[name=devSwitch]").next().addClass("lcs_off");
						$("input[name=devSwitch]").next().removeClass("lcs_on");
					}
				}
			});
			// 终端升级设置
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=update',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {
					var config = data.data.data.config;
					if (config['virdb_only'] == true) {
						$("input[name=virusUp]").prop("checked", true);
					} else {
						$("input[name=virusUp]").prop("checked", false);
					}
					if (config['tips_hide'] == true) {
						$("input[name=alertTips]").prop("checked", true);
					} else {
						$("input[name=alertTips]").prop("checked", false);
					}
				}
			});

			// 拓展工具
			// $.ajax({
			// 	url: '/mgr/policy/_info?id=' + policyid + '&fname=toolbox',
			// 	data: {},
			// 	type: 'GET',
			// 	contentType: 'text/plain',
			// 	error: function (xhr, textStatus, errorThrown) {
			// 		if (xhr.status == 401) {
			// 			parent.window.location.href = '/';
			// 		} else {

			// 		}

			// 	},
			// 	success: function (data) {
			// 		var config = data.data.data.config;
			// 		if (config['rclickman'] == true) {
			// 			$("input[name=rclickman]").prop("checked", true);
			// 		} else {
			// 			$("input[name=rclickman]").prop("checked", false);
			// 		}
			// 		if (config['sysclean'] == true) {
			// 			$("input[name=sysclean]").prop("checked", true);
			// 		} else {
			// 			$("input[name=sysclean]").prop("checked", false);
			// 		}
			// 		if (config['fileshred'] == true) {
			// 			$("input[name=fileshred]").prop("checked", true);
			// 		} else {
			// 			$("input[name=fileshred]").prop("checked", false);
			// 		}
			// 		if (config['popblock'] == true) {
			// 			$("input[name=popblock]").prop("checked", true);
			// 		} else {
			// 			$("input[name=popblock]").prop("checked", false);
			// 		}
			// 		if (config['autoruns'] == true) {
			// 			$("input[name=autoruns]").prop("checked", true);
			// 		} else {
			// 			$("input[name=autoruns]").prop("checked", false);
			// 		}
			// 		if (config['netflow'] == true) {
			// 			$("input[name=netflow]").prop("checked", true);
			// 		} else {
			// 			$("input[name=netflow]").prop("checked", false);
			// 		}
			// 		if (config['leakrepair'] == true) {
			// 			$("input[name=leakrepair]").prop("checked", true);
			// 		} else {
			// 			$("input[name=leakrepair]").prop("checked", false);
			// 		}
			// 	}
			// });

			// 病毒查杀
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=scan',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config['decompo.limit.size'].enable == true) {
						$("input[name=overallSet1]").prop("checked", true);
						$("input[name=overallPara1]").val(config['decompo.limit.size'].value)
					} else {
						$("input[name=overallSet1]").prop("checked", false);
						$("input[name=overallPara1]").val("");
					}
					if (config['scan.exclusion.ext'].enable == true) {
						$("input[name=overallSet2]").prop("checked", true);
						$("input[name=overallPara2]").val(config['scan.exclusion.ext'].value)
					} else {
						$("input[name=overallSet2]").prop("checked", false);
						$("input[name=overallPara2]").val("");
					}
					if (config['scan.maxspeed'] == true) {
						$("input[name=sKSpeed][value='1']").prop("checked", true);
					} else {
						$("input[name=sKSpeed][value='0']").prop("checked", true);
					}
					if (config['scan.sysrepair'] == true) {
						$("input[name=systemRep]").prop("checked", true);
					} else {
						$("input[name=systemRep]").prop("checked", false);
					}
					if (config['clean.automate'] == true) {
						$("input[name=actionV][value='0']").prop("checked", true);
					} else {
						$("input[name=actionV][value='1']").prop("checked", true);
					}
					if (config['clean.quarantine'] == true) {
						$("input[name=backup]").prop("checked", true);
					} else {
						$("input[name=backup]").prop("checked", false);
					}
					if (config['scan.on.boot'].enable == true) {
						$("input[name=startAuto]").prop("checked", true);
					} else {
						$("input[name=startAuto").prop("checked", false);
					}
					if (config['scan.on.boot'].type == 0) {
						$("input[name=startAutoType][value='0']").prop("checked", true);
						$("input[name=startAutoType][value='1']").prop("checked", false);
					} else {
						$("input[name=startAutoType][value='1']").prop("checked", true);
						$("input[name=startAutoType][value='0']").prop("checked", false);
					}

				}
			});
			// 文件实时监控
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=filemon',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config['scan.leve'] == 0) {
						$("input[name=scanOp][value='0']").prop("checked", true);
					} else if (config['scan.leve'] == 1) {
						$("input[name=scanOp][value='1']").prop("checked", true);
					} else {
						$("input[name=scanOp][value='2']").prop("checked", true);
					}
					if (config['clean.automate'] == true) {
						$("input[name=virusFind][value='0']").prop("checked", true);
					} else {
						$("input[name=virusFind][value='1']").prop("checked", true);
					}
					if (config['clean.quarantine'] == true) {
						$("input[name=backupF]").prop("checked", true);
					} else {
						$("input[name=backupF]").prop("checked", false);
					}
					if (config['scan.exclusion.file'].enable == true) {
						$("input[name=debar]").prop("checked", true);
						$("input[name=debarV]").val(config['scan.exclusion.file'].value);
						$("input[name=debarV]").next().hide();
					} else {
						$("input[name=debar]").prop("checked", false);
						$("input[name=debarV]").val("");
						$("input[name=debarV]").next().hide();
					}

				}
			});
			// 恶意行为监控
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=behavior',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config['clean.automate'] == true) {
						$("input[name=virusFindBAM][value='0']").prop("checked", true);
					} else {
						$("input[name=virusFindBAM][value='1']").prop("checked", true);
					}
					if (config['clean.quarantine'] == true) {
						$("input[name=backupBAM]").prop("checked", true);
					} else {
						$("input[name=backupBAM]").prop("checked", false);
					}
					if (config['bait.enable'] == true) {
						$("input[name=blackMailBAM]").prop("checked", true);
					} else {
						$("input[name=blackMailBAM]").prop("checked", false);
					}
				}
			});
			// U盘保护
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=udiskmon',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config['clean.automate'] == true) {
						$("input[name=virusFindUP][value='0']").prop("checked", true);
					} else {
						$("input[name=virusFindUP][value='1']").prop("checked", true);
					}
					if (config['clean.quarantine'] == true) {
						$("input[name=backupUP]").prop("checked", true);
					} else {
						$("input[name=backupUP]").prop("checked", false);
					}
					if (config.scan == true) {
						$("input[name=cutIn2]").prop("checked", true);
					} else {
						$("input[name=cutIn2]").prop("checked", false);
					}
					if (config.repair == true) {
						$("input[name=cutIn1]").prop("checked", true);
					} else {
						$("input[name=cutIn1]").prop("checked", false);
					}
					if (config['decompo.limit.size'].enable == true) {
						$("input[name=zipSet]").prop("checked", true);
						$("input[name=zipSetV]").val(config['decompo.limit.size'].value)
					} else {
						$("input[name=zipSet]").prop("checked", false);
						$("input[name=zipSetV]").val("");
					}

				}
			});
			//下载保护
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=dlmon',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config['clean.automate'] == true) {
						$("input[name=virusFindDP][value='0']").prop("checked", true);
					} else {
						$("input[name=virusFindDP][value='1']").prop("checked", true);
					}
					if (config['clean.quarantine'] == true) {
						$("input[name=backupDP]").prop("checked", true);
					} else {
						$("input[name=backupDP]").prop("checked", false);
					}
					if (config['decompo.limit.size'].enable == true) {
						$("input[name=zipSetDP]").prop("checked", true);
						$("input[name=zipSetDPV]").val(config['decompo.limit.size'].value)
					} else {
						$("input[name=zipSetDP]").prop("checked", false);
						$("input[name=zipSetDPV]").val("");
					}
					if (config['scan.exclusion.ext'].enable == true) {
						$("input[name=debarDP]").prop("checked", true);
						$("input[name=debarDPV]").val(config['scan.exclusion.ext'].value)
					} else {
						$("input[name=debarDP]").prop("checked", false);
						$("input[name=debarDPV]").val("");
						$("input[name=debarDPV]").next().hide();
					}

				}
			});
			//软件安装拦截
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=instmon',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config.autoblock == false) {
						$("input[name=actionII][value='0']").prop("checked", true);
					} else {
						$("input[name=actionII][value='1']").prop("checked", true);
					}

				}
			});
			//浏览器保护
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=browserprot',
				data: {},
				type: 'GET',
				contentType: 'text/plain', 				
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config['startpage.blank'] == true) {
						$("input[name=startpage][value='0']").prop("checked", true);
					} else {
						$("input[name=startpage][value='1']").prop("checked", true);
						$("input[name=webpage]").val(config['startpage.site'])
					}

				}
			});
			//邮件监控
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=mail',
				data: {},
				type: 'GET',
				contentType: 'text/plain', 				
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					var mailRTable = "";
					if (config['clean.quarantine'] == true) {
						$("input[name=backupMM]").prop("checked", true);
					} else {
						$("input[name=backupMM]").prop("checked", false);
					}
					if (config['decompo.limit.size'].enable == true) {
						$("input[name=zipSetMMV]").val(config['decompo.limit.size'].value)
					} else {
						$("input[name=zipSetMMV]").val("");
					}

					mailRTable +=
						"<tr><th width='10%'><input type='checkbox' onclick='selectAllFP(this)' class='verticalMiddle'></th><th width='36%'>端口</th><th width='36%'>协议</th><th width='18%'>操作</th></tr>";

					for (var i = 0; i < config.list.length; i++) {
						mailRTable += "<tr>";
						mailRTable += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";
						mailRTable += "<td><input type='text' class='portInput' value=" + config.list[i].port +
							" maxlength='5'></td>";
						mailRTable += "<td>";
						if (config.list[i].type == 0) {
							mailRTable += "<select>";
							mailRTable += "<option value=0 selected>SMTP</option>";
							mailRTable += "<option value=1>POP3</option>";
							mailRTable += "</select>";
						} else {
							mailRTable += "<select>";
							mailRTable += "<option value=0>SMTP</option>";
							mailRTable += "<option value=1 selected>POP3</option>";
							mailRTable += "</select>";
						}

						mailRTable += "</td>";
						mailRTable +=
							"<td><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
						mailRTable += "</tr>";
					}
					$(".mailMTable table").html(mailRTable)
				}
			});
			//黑客入侵拦截
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=intrusion',
				data: {},
				type: 'GET',
				contentType: 'text/plain', 				
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config.block == true) {
						$("input[name=actionHI][value='0']").prop("checked", true);
					} else {
						$("input[name=actionHI][value='1']").prop("checked", true);
					}

				}
			});
			//对外攻击检测
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=ipattack',
				data: {},
				type: 'GET',
				contentType: 'text/plain', 				
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					if (config.block == true) {
						$("input[name=actionAC][value='0']").prop("checked", true);
					} else {
						$("input[name=actionAC][value='1']").prop("checked", true);
					}

				}
			});
			//恶意网址拦截
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=malsite',
				data: {},
				type: 'GET',
				contentType: 'text/plain', 				
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					if (data.data.data.config['vendor.fraud'] == true) {

						$("input[name=fraud]").prop("checked", true);
						$("input[name=fraud]").next().addClass("lcs_on");
						$("input[name=fraud]").next().removeClass("lcs_off");
					} else {
						$("input[name=fraud]").prop("checked", false);
						$("input[name=fraud]").next().addClass("lcs_off");
						$("input[name=fraud]").next().removeClass("lcs_on");
					}
					if (data.data.data.config['vendor.spy'] == true) {
						$("input[name=spy]").prop("checked", true);
						$("input[name=spy]").next().addClass("lcs_on");
						$("input[name=spy]").next().removeClass("lcs_off");
					} else {
						$("input[name=spy]").prop("checked", false);
						$("input[name=spy]").next().addClass("lcs_off");
						$("input[name=spy]").next().removeClass("lcs_on");
					}
					if (data.data.data.config['vendor.phising'] == true) {
						$("input[name=phising]").prop("checked", true);
						$("input[name=phising]").next().addClass("lcs_on");
						$("input[name=phising]").next().removeClass("lcs_off");
					} else {
						$("input[name=phising]").prop("checked", false);
						$("input[name=phising]").next().addClass("lcs_off");
						$("input[name=phising]").next().removeClass("lcs_on");
					}
				}
			});
			//系统加固
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=sysprot',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config;
					var filePTable = "";
					var registryPTable = "";
					var executeDTable = "";
					var virusITable = "";
					var actionITable = "";
					var processPTable = "";
					if (config['whitelist.enable'] == true) {
						$("input[name=autoHandle]").prop("checked", true);
					} else {
						$("input[name=autoHandle]").prop("checked", false);
					}
					filePTable += "<tr>";
					filePTable += "<th width='12'>";
					filePTable += "<input type='checkbox' onclick='selectAllFP(this)' class='selectAll'>";
					filePTable += "</th>";
					filePTable += "<th width='500'>";
					filePTable += "<span class='verticalMiddle'>防护项目</span>";
					filePTable += "</th>";
					filePTable += "<th width='150'>";
					filePTable += "<span class='verticalMiddle'>生效方式</span>";
					filePTable += "</th>";
					filePTable += "</tr>";
					var truefilePNum = 0;
					var filePNum = 0;
					$.each(config['protect.file'], function (k, i) {
						filePNum = filePNum + 1;
						filePTable += "<tr>";
						filePTable += "<td>";
						if (i.enable == true) {
							filePTable +=
								"<input type='checkbox' class='selectFP defendS' checked='checked'>";
							truefilePNum = truefilePNum + 1;

						} else {
							filePTable += "<input type='checkbox' class='selectFP defendS'>";

						}
						filePTable += "</td>";
						filePTable += "<td>";
						filePTable += "<span class='verticalMiddle projectN'>" + k + "</span><br/>";
						filePTable += "<span class='verticalMiddle defendI'>" + safeStr(i.description) +
							"</span>";
						filePTable += "</td>";
						filePTable += "<td>";
						if (i.treatment == 0) {
							filePTable += "<select class='efficientT'>";
							filePTable += "<option selected value='0'>自动允许</option>";
							filePTable += "<option value='1'>自动阻止</option>";
							filePTable += "<option value='2'>弹窗提示</option>";
							filePTable += "</select>";
						} else if (i.treatment == 1) {
							filePTable += "<select class='efficientT'>";
							filePTable += "<option value='0'>自动允许</option>";
							filePTable += "<option selected value='1'>自动阻止</option>";
							filePTable += "<option value='2'>弹窗提示</option>";
							filePTable += "</select>";
						} else {
							filePTable += "<select class='efficientT'>";
							filePTable += "<option value='0'>自动允许</option>";
							filePTable += "<option value='1'>自动阻止</option>";
							filePTable += "<option selected value='2'>弹窗提示</option>";
							filePTable += "</select>";
						}
						filePTable += "</td>";
						filePTable += "</tr>";
					})
					$("#filePTable").html(filePTable);
					$("#filePTable").prev().find(".td2").html("已开启" + $("#filePTable").find(".defendS:checked")
						.length + "项");
					if (truefilePNum == filePNum) {
						$("#filePTable .selectAll").prop("checked", true);
					}

					registryPTable += "<tr>";
					registryPTable += "<th width='12'>";
					registryPTable += "<input type='checkbox' onclick='selectAllFP(this)' class='selectAll'>";
					registryPTable += "</th>";
					registryPTable += "<th width='500'>";
					registryPTable += "<span class='verticalMiddle'>防护项目</span>";
					registryPTable += "</th>";
					registryPTable += "<th width='150'>";
					registryPTable += "<span class='verticalMiddle'>生效方式</span>";
					registryPTable += "</th>";
					registryPTable += "</tr>";
					var trueregistryPNum = 0;
					var registryPNum = 0;
					$.each(config['protect.reg'], function (k, i) {
						registryPNum = registryPNum + 1;
						registryPTable += "<tr>";
						registryPTable += "<td>";
						if (i.enable == true) {
							registryPTable +=
								"<input type='checkbox' class='selectFP defendS' checked='checked'>";
							trueregistryPNum = trueregistryPNum + 1;

						} else {
							registryPTable += "<input type='checkbox' class='selectFP defendS'>";

						}
						registryPTable += "</td>";
						registryPTable += "<td>";
						registryPTable += "<span class='verticalMiddle projectN'>" + k + "</span><br/>";
						registryPTable += "<span class='verticalMiddle defendI'>" + safeStr(i
							.description) + "</span>";
						registryPTable += "</td>";
						registryPTable += "<td>";
						if (i.treatment == 0) {
							registryPTable += "<select class='efficientT'>";
							registryPTable += "<option selected value='0'>自动允许</option>";
							registryPTable += "<option value='1'>自动阻止</option>";
							registryPTable += "<option value='2'>弹窗提示</option>";
							registryPTable += "</select>";
						} else if (i.treatment == 1) {
							registryPTable += "<select class='efficientT'>";
							registryPTable += "<option value='0'>自动允许</option>";
							registryPTable += "<option selected value='1'>自动阻止</option>";
							registryPTable += "<option value='2'>弹窗提示</option>";
							registryPTable += "</select>";
						} else {
							registryPTable += "<select class='efficientT'>";
							registryPTable += "<option value='0'>自动允许</option>";
							registryPTable += "<option value='1'>自动阻止</option>";
							registryPTable += "<option selected value='2'>弹窗提示</option>";
							registryPTable += "</select>";
						}
						registryPTable += "</td>";
						registryPTable += "</tr>";
					})
					$("#registryPTable").html(registryPTable);
					$("#registryPTable").prev().find(".td2").html("已开启" + $("#registryPTable").find(
						".defendS:checked").length + "项");
					if (registryPNum == trueregistryPNum) {
						$("#registryPTable .selectAll").prop("checked", true);
					}

					executeDTable += "<tr>";
					executeDTable += "<th width='12'>";
					executeDTable += "<input type='checkbox' onclick='selectAllFP(this)' class='selectAll'>";
					executeDTable += "</th>";
					executeDTable += "<th width='500'>";
					executeDTable += "<span class='verticalMiddle'>防护项目</span>";
					executeDTable += "</th>";
					executeDTable += "<th width='150'>";
					executeDTable += "<span class='verticalMiddle'>生效方式</span>";
					executeDTable += "</th>";
					executeDTable += "</tr>";
					var executeDNum = 0;
					var trueexecuteDNum = 0;

					$.each(config['protect.run'], function (k, i) {
						executeDNum = executeDNum + 1;
						executeDTable += "<tr>";
						executeDTable += "<td>";
						if (i.enable == true) {
							executeDTable +=
								"<input type='checkbox' class='selectFP defendS' checked='checked'>";
							trueexecuteDNum = trueexecuteDNum + 1;

						} else {
							executeDTable += "<input type='checkbox' class='selectFP defendS'>";

						}
						executeDTable += "</td>";
						executeDTable += "<td>";
						executeDTable += "<span class='verticalMiddle projectN'>" + k + "</span><br/>";
						executeDTable += "<span class='verticalMiddle defendI'>" + safeStr(i
							.description) + "</span>";
						executeDTable += "</td>";
						executeDTable += "<td>";
						if (i.treatment == 0) {
							executeDTable += "<select class='efficientT'>";
							executeDTable += "<option selected value='0'>自动允许</option>";
							executeDTable += "<option value='1'>自动阻止</option>";
							executeDTable += "<option value='2'>弹窗提示</option>";
							executeDTable += "</select>";
						} else if (i.treatment == 1) {
							executeDTable += "<select class='efficientT'>";
							executeDTable += "<option value='0'>自动允许</option>";
							executeDTable += "<option selected value='1'>自动阻止</option>";
							executeDTable += "<option value='2'>弹窗提示</option>";
							executeDTable += "</select>";
						} else {
							executeDTable += "<select class='efficientT'>";
							executeDTable += "<option value='0'>自动允许</option>";
							executeDTable += "<option value='1'>自动阻止</option>";
							executeDTable += "<option selected value='2'>弹窗提示</option>";
							executeDTable += "</select>";
						}
						executeDTable += "</td>";
						executeDTable += "</tr>";
					})
					$("#executeDTable").html(executeDTable);
					$("#executeDTable").prev().find(".td2").html("已开启" + $("#executeDTable").find(
						".defendS:checked").length + "项");
					if (executeDNum == trueexecuteDNum) {
						$("#executeDTable .selectAll").prop("checked", true);
					}

					virusITable += "<tr>";
					virusITable += "<th width='12'>";
					virusITable += "<input type='checkbox' onclick='selectAllFP(this)' class='selectAll'>";
					virusITable += "</th>";
					virusITable += "<th width='500'>";
					virusITable += "<span class='verticalMiddle'>防护项目</span>";
					virusITable += "</th>";
					virusITable += "<th width='150'>";
					virusITable += "<span class='verticalMiddle'>生效方式</span>";
					virusITable += "</th>";
					virusITable += "</tr>";
					var virusINum = 0;
					var truevirusINum = 0;

					$.each(config['protect.immune'], function (k, i) {
						virusINum = virusINum + 1;
						virusITable += "<tr>";
						virusITable += "<td>";
						if (i.enable == true) {
							virusITable +=
								"<input type='checkbox' class='selectFP defendS' checked='checked'>";
							truevirusINum = truevirusINum + 1;

						} else {
							virusITable += "<input type='checkbox' class='selectFP defendS'>";

						}
						virusITable += "</td>";
						virusITable += "<td>";
						virusITable += "<span class='verticalMiddle projectN'>" + k + "</span><br/>";
						virusITable += "<span class='verticalMiddle defendI'>" + safeStr(i.description) +
							"</span>";

						virusITable += "</td>";
						virusITable += "<td>";
						if (i.treatment == 0) {
							virusITable += "<select class='efficientT'>";
							virusITable += "<option selected value='0'>自动允许</option>";
							virusITable += "<option value='1'>自动阻止</option>";
							virusITable += "<option value='2'>弹窗提示</option>";
							virusITable += "</select>";
						} else if (i.treatment == 1) {
							virusITable += "<select class='efficientT'>";
							virusITable += "<option value='0'>自动允许</option>";
							virusITable += "<option selected value='1'>自动阻止</option>";
							virusITable += "<option value='2'>弹窗提示</option>";
							virusITable += "</select>";
						} else {
							virusITable += "<select class='efficientT'>";
							virusITable += "<option value='0'>自动允许</option>";
							virusITable += "<option value='1'>自动阻止</option>";
							virusITable += "<option selected value='2'>弹窗提示</option>";
							virusITable += "</select>";
						}
						virusITable += "</td>";
						virusITable += "</tr>";
					})
					$("#virusITable").html(virusITable);
					$("#virusITable").prev().find(".td2").html("已开启" + $("#virusITable").find(".defendS:checked")
						.length + "项");
					if (virusINum == truevirusINum) {
						$("#virusITable .selectAll").prop("checked", true);
					}
					// 危险动作拦截
					actionITable += "<tr>";
					actionITable += "<th width='12'>";
					if (policyid == 1) {
						actionITable +=
							"<input type='checkbox' onclick='selectAllFP(this)' class='selectAll' disabled>";
					} else {
						actionITable += "<input type='checkbox' onclick='selectAllFP(this)' class='selectAll'>";
					}

					actionITable += "</th>";
					actionITable += "<th width='500'>";
					actionITable += "<span class='verticalMiddle'>防护项目</span>";
					actionITable += "</th>";
					actionITable += "<th width='150'>";
					actionITable += "<span class='verticalMiddle'>生效方式</span>";
					actionITable += "</th>";
					actionITable += "</tr>";
					var actionINum = 0;
					var trueactionINum = 0;
					$.each(config['protect.risk'], function (k, i) {
						actionINum = actionINum + 1;
						actionITable += "<tr>";
						actionITable += "<td>";
						if (i.enable == true) {
							if (policyid == 1) {
								actionITable +=
									"<input type='checkbox' class='selectFP defendS' checked='checked' disabled>";
							} else {
								actionITable +=
									"<input type='checkbox' class='selectFP defendS' checked='checked'>";
							}

							trueactionINum = trueactionINum + 1;

						} else {
							if (policyid == 1) {
								actionITable +=
									"<input type='checkbox' class='selectFP defendS' disabled>";
							} else {
								actionITable += "<input type='checkbox' class='selectFP defendS'>";
							}

						}
						actionITable += "</td>";
						actionITable += "<td>";
						actionITable += "<span class='verticalMiddle projectN'>" + k + "</span><br/>";
						actionITable += "<span class='verticalMiddle defendI'>" + safeStr(i.description) +
							"</span>";

						actionITable += "</td>";
						actionITable += "<td>";
						if (policyid == 1) {
							actionITable += "<select class='efficientT' disabled>";
						} else {
							actionITable += "<select class='efficientT'>";
						}

						if (i.treatment == 0) {

							actionITable += "<option selected value='0'>自动允许</option>";
							actionITable += "<option value='1'>自动阻止</option>";
							actionITable += "<option value='2'>弹窗提示</option>";

						} else if (i.treatment == 1) {

							actionITable += "<option value='0'>自动允许</option>";
							actionITable += "<option selected value='1'>自动阻止</option>";
							actionITable += "<option value='2'>弹窗提示</option>";

						} else {

							actionITable += "<option value='0'>自动允许</option>";
							actionITable += "<option value='1'>自动阻止</option>";
							actionITable += "<option selected value='2'>弹窗提示</option>";

						}
						actionITable += "</select>";
						actionITable += "</td>";
						actionITable += "</tr>";
					})
					$("#actionITable").html(actionITable);
					$("#actionITable").prev().find(".td2").html("已开启" + $("#actionITable").find(
						".defendS:checked").length + "项");
					if (actionINum == trueactionINum) {
						$("#actionITable .selectAll").prop("checked", true);
					}
					// 进程保护
					processPTable += "<tr>";
					processPTable += "<th width='12'>";
					if (policyid == 1) {
						processPTable +=
							"<input type='checkbox' onclick='selectAllFP(this)' class='selectAll' disabled>";
					} else {
						processPTable += "<input type='checkbox' onclick='selectAllFP(this)' class='selectAll'>";
					}

					processPTable += "</th>";
					processPTable += "<th width='500'>";
					processPTable += "<span class='verticalMiddle'>防护项目</span>";
					processPTable += "</th>";
					processPTable += "<th width='150'>";
					processPTable += "<span class='verticalMiddle'>生效方式</span>";
					processPTable += "</th>";
					processPTable += "</tr>";
					var processPNum = 0;
					var trueprocessPNum = 0;
					$.each(config['protect.process'], function (k, i) {
						processPNum = processPNum + 1;
						processPTable += "<tr>";
						processPTable += "<td>";
						if (i.enable == true) {
							if (policyid == 1) {
								processPTable +=
									"<input type='checkbox' class='selectFP defendS' checked='checked' disabled>";
							} else {
								processPTable +=
									"<input type='checkbox' class='selectFP defendS' checked='checked'>";
							}

							trueprocessPNum = trueprocessPNum + 1;

						} else {
							if (policyid == 1) {
								processPTable +=
									"<input type='checkbox' class='selectFP defendS' disabled>";
							} else {
								processPTable += "<input type='checkbox' class='selectFP defendS'>";
							}

						}
						processPTable += "</td>";
						processPTable += "<td>";
						processPTable += "<span class='verticalMiddle projectN'>" + k + "</span><br/>";
						processPTable += "<span class='verticalMiddle defendI'>" + safeStr(i
							.description) + "</span>";

						processPTable += "</td>";
						processPTable += "<td>";
						if (policyid == 1) {
							processPTable += "<select class='efficientT' disabled>";
						} else {
							processPTable += "<select class='efficientT'>";
						}

						if (i.treatment == 0) {

							processPTable += "<option selected value='0'>自动允许</option>";
							processPTable += "<option value='1'>自动阻止</option>";
							processPTable += "<option value='2'>弹窗提示</option>";

						} else if (i.treatment == 1) {

							processPTable += "<option value='0'>自动允许</option>";
							processPTable += "<option selected value='1'>自动阻止</option>";
							processPTable += "<option value='2'>弹窗提示</option>";

						} else {

							processPTable += "<option value='0'>自动允许</option>";
							processPTable += "<option value='1'>自动阻止</option>";
							processPTable += "<option selected value='2'>弹窗提示</option>";

						}
						processPTable += "</select>";
						processPTable += "</td>";
						processPTable += "</tr>";
					})
					$("#processPTable").html(processPTable);
					$("#processPTable").prev().find(".td2").html("已开启" + $("#processPTable").find(
						".defendS:checked").length + "项");
					if (processPNum == trueprocessPNum) {
						$("#processPTable .selectAll").prop("checked", true);
					}

				}
			});
			//IP黑名单
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=ipblacklist',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config.list;
					var blackLTable = "";

					if (policyid == 1) {
						blackLTable +=
							"<tr><th width='10%'><input type='checkbox' onclick='selectAllFP(this)' class='verticalMiddle' disabled></th><th width='36%'>远程IP</th><th width='36%'>备注</th><th width='18%'>操作</th></tr>";
					} else {
						blackLTable +=
							"<tr><th width='10%'><input type='checkbox' onclick='selectAllFP(this)' class='verticalMiddle'></th><th width='36%'>远程IP</th><th width='36%'>备注</th><th width='18%'>操作</th></tr>";
					}

					for (var i = 0; i < config.length; i++) {
						blackLTable += "<tr>";
						blackLTable += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";
						if (config[i].raddr_type == 0) {
							blackLTable += "<td raddr_type=0>";
						} else {
							blackLTable += "<td raddr_type=1>";
						}

						blackLTable += "<span class='ipstart'>" + _int2ip(config[i].raddr) + "</span>";
						if (config[i].raddr_type == 1) {
							blackLTable += "-" + "<span class='ipend'>" + _int2ip(config[i].raddr_end) +
								"</span>";
						}
						blackLTable += "</td>";
						blackLTable += "<td><span class='txtWidth' title=" + pathtitle(safeStr(config[i].memo)) +
							">" + safeStr(config[i].memo) + "</span></td>";
						blackLTable +=
							"<td><a class='underline blackfont opButton cursor' onclick='editBLB(this)'>编辑</a><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
						blackLTable += "</tr>";
					}
					$(".blackLTable table").html(blackLTable)
				}
			});
			//IP协议控制
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=ipproto',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					var config = data.data.data.config.list;
					var protocolCTable = "";

					if (policyid == 1) {
						protocolCTable +=
							"<tr><th width='10%'><input type='checkbox' onclick='selectAllFP(this)' class='verticalMiddle' disabled></th><th width='15%'>规则名</th><th width='50%'>说明</th><th width='10%'>启用</th><th width='15%'>操作</th></tr>";
					} else {
						protocolCTable +=
							"<tr><th width='10%'><input type='checkbox' onclick='selectAllFP(this)' class='verticalMiddle'></th><th width='15%'>规则名</th><th width='50%'>说明</th><th width='10%'>启用</th><th width='15%'>操作</th></tr>";
					}

					for (var i = 0; i < config.length; i++) {
						protocolCTable += "<tr>";

						protocolCTable += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";

						protocolCTable += "<td><span>" + safeStr(config[i].name) + "</span></td>";
						if (config[i].block == 0) {
							protocolCTable += "<td>" + "操作:<span class='ope' opev=" + config[i].block +
								">放行</span>";
						} else {
							protocolCTable += "<td>" + "操作:<span class='ope' opev=" + config[i].block +
								">阻止</span>";
						}
						if (config[i].direction == 0) {
							protocolCTable += " 方向:<span class='dir' dirv=" + config[i].direction + ">所有</span>";
						} else if (config[i].direction == 1) {
							protocolCTable += " 方向:<span class='dir' dirv=" + config[i].direction + ">入站</span>";
						} else {
							protocolCTable += " 方向:<span class='dir' dirv=" + config[i].direction + ">出站</span>";
						}

						protocolCTable += " 协议:<span class='pro' prov=" + config[i].protocol;
						protocolCTable += " icmp=" + config[i].icmp_type + ">";
						if (config[i].protocol == 1) {
							protocolCTable += "ICMP</span><br/>";
						} else if (config[i].protocol == 2) {
							protocolCTable += "IGMP</span><br/>";
						} else if (config[i].protocol == 3) {
							protocolCTable += "GGP</span><br/>";
						} else if (config[i].protocol == 260) {
							protocolCTable += "TCP/UDP</span><br/>";
						} else if (config[i].protocol == 6) {
							protocolCTable += "TCP</span><br/>";
						} else if (config[i].protocol == 17) {
							protocolCTable += "UDP</span><br/>";
						} else if (config[i].protocol == 12) {
							protocolCTable += "PUP</span><br/>";
						} else if (config[i].protocol == 22) {
							protocolCTable += "IDP</span><br/>";
						} else if (config[i].protocol == 77) {
							protocolCTable += "ND</span><br/>";
						} else if (config[i].protocol == 50) {
							protocolCTable += "ESP</span><br/>";
						} else if (config[i].protocol == 51) {
							protocolCTable += "AH</span><br/>";
						} else if (config[i].protocol == 47) {
							protocolCTable += "GRE</span><br/>";
						} else if (config[i].protocol == 27) {
							protocolCTable += "RDP</span><br/>";
						} else if (config[i].protocol == 57) {
							protocolCTable += "SKIP</span><br/>";
						} else if (config[i].protocol == 255) {
							protocolCTable += "RAW</span><br/>";
						}

						if (config[i].laddr == "*") {
							protocolCTable += "<span class='introWidth'>本地IP:<span class='localip'>任意IP</span>";
						} else {
							protocolCTable += "<span class='introWidth'>本地IP:<span class='localip'>" + config[i]
								.laddr + "</span>";
						}
						if (config[i].lport == "*") {
							protocolCTable += "&nbsp;本地端口:<span class='localport'>任意端口</span>";
						} else if (config[i].lport == "") {
							protocolCTable += "&nbsp;本地端口:<span class='localport'>无</span>";
						} else {
							protocolCTable += "&nbsp;本地端口:<span class='localport'>" + config[i].lport + "</span>";
						}
						if (config[i].raddr == "*") {
							protocolCTable += "&nbsp;远程IP:<span class='remoteip'>任意IP</span>";
						} else {
							protocolCTable += "&nbsp;远程IP:<span class='remoteip'>" + config[i].raddr + "</span>";
						}
						if (config[i].rport == "*") {
							protocolCTable += "&nbsp;远程端口:<span class='remoteport'>任意端口</span>";
						} else if (config[i].rport == "") {
							protocolCTable += "&nbsp;远程端口:<span class='remoteport'>无</span>";
						} else {
							protocolCTable += "&nbsp;远程端口:<span class='remoteport'>" + config[i].rport +
								"</span>";
						}
						protocolCTable += "</span>";
						protocolCTable += "</td>";
						if (config[i].enabled == true) {
							protocolCTable += "<td>" + "<input type='checkbox' class='verticalMiddle' checked>" +
								"</td>";
						} else {
							protocolCTable += "<td>" + "<input type='checkbox' class='verticalMiddle'>" + "</td>";
						}

						protocolCTable +=
							"<td><a class='underline blackfont opButton cursor' onclick='editPCB(this)'>编辑</a><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
						protocolCTable += "</tr>";
					}
					$(".protocolCTable table").html(protocolCTable)
				}
			});


			//设备控制
			$.ajax({
				url: '/mgr/policy/_info?id=' + policyid + '&fname=devmgr',
				data: {},
				type: 'GET',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {
					if (data.data.data.config.settings.udisk == true) {

						$("input[name=udisk]").prop("checked", true);
						$("input[name=udisk]").next().addClass("lcs_on");
						$("input[name=udisk]").next().removeClass("lcs_off");
					} else {
						$("input[name=udisk]").prop("checked", false);
						$("input[name=udisk]").next().addClass("lcs_off");
						$("input[name=udisk]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.settings.portable == true) {
						$("input[name=portable]").prop("checked", true);
						$("input[name=portable]").next().addClass("lcs_on");
						$("input[name=portable]").next().removeClass("lcs_off");
					} else {
						$("input[name=portable]").prop("checked", false);
						$("input[name=portable]").next().addClass("lcs_off");
						$("input[name=portable]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.settings['usb-wifi'] == true) {
						$("input[name=usb-wifi]").prop("checked", true);
						$("input[name=usb-wifi]").next().addClass("lcs_on");
						$("input[name=usb-wifi]").next().removeClass("lcs_off");
					} else {
						$("input[name=usb-wifi]").prop("checked", false);
						$("input[name=usb-wifi]").next().addClass("lcs_off");
						$("input[name=usb-wifi]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.settings['usb-netcard'] == true) {
						$("input[name=usb-netcard]").prop("checked", true);
						$("input[name=usb-netcard]").next().addClass("lcs_on");
						$("input[name=usb-netcard]").next().removeClass("lcs_off");
					} else {
						$("input[name=usb-netcard]").prop("checked", false);
						$("input[name=usb-netcard]").next().addClass("lcs_off");
						$("input[name=usb-netcard]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.settings.printer == true) {
						$("input[name=printer]").prop("checked", true);
						$("input[name=printer]").next().addClass("lcs_on");
						$("input[name=printer]").next().removeClass("lcs_off");
					} else {
						$("input[name=printer]").prop("checked", false);
						$("input[name=printer]").next().addClass("lcs_off");
						$("input[name=printer]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.settings.cdrom == true) {
						$("input[name=cdrom]").prop("checked", true);
						$("input[name=cdrom]").next().addClass("lcs_on");
						$("input[name=cdrom]").next().removeClass("lcs_off");
					} else {
						$("input[name=cdrom]").prop("checked", false);
						$("input[name=cdrom]").next().addClass("lcs_off");
						$("input[name=cdrom]").next().removeClass("lcs_on");
					}
					if (data.data.data.config.settings.bluetooth == true) {
						$("input[name=bluetooth]").prop("checked", true);
						$("input[name=bluetooth]").next().addClass("lcs_on");
						$("input[name=bluetooth]").next().removeClass("lcs_off");
					} else {
						$("input[name=bluetooth]").prop("checked", false);
						$("input[name=bluetooth]").next().addClass("lcs_off");
						$("input[name=bluetooth]").next().removeClass("lcs_on");
					}

					if (data.data.data.config['tips.hide'] == true) {
						$("input[name=tipsHide]").prop("checked", true);
					} else {
						$("input[name=tipsHide]").prop("checked", false);
					}


				}
			});

		}
		//确认修改策略信息
		function sureEditButton(a) {
			var fmswitchs = "";
			var bamswitchs = "";
			var upswitchs = "";
			var dpswitchs = "";
			var srswitchs = "";
			var siswitchs = "";
			var bpswitchs = "";
			var hiswitchs = "";
			var acswitchs = "";
			var wiswitchs = "";
			var pcswitchs = "";
			var blswitchs = "";
			if ($("input[name=fMSwitch]").is(":checked")) {
				fmswitchs = true;
			} else {
				fmswitchs = false;
			}
			if ($("input[name=bAMSwitch]").is(":checked")) {
				bamswitchs = true;
			} else {
				bamswitchs = false;
			}
			if ($("input[name=uPSwitch]").is(":checked")) {
				upswitchs = true;
			} else {
				upswitchs = false;
			}
			if ($("input[name=dPSwitch]").is(":checked")) {
				dpswitchs = true;
			} else {
				dpswitchs = false;
			}
			if ($("input[name=sRSwitch]").is(":checked")) {
				srswitchs = true;
			} else {
				srswitchs = false;
			}
			if ($("input[name=sISwitch]").is(":checked")) {
				siswitchs = true;
			} else {
				siswitchs = false;
			}
			if ($("input[name=bPSwitch]").is(":checked")) {
				bpswitchs = true;
			} else {
				bpswitchs = false;
			}
			if ($("input[name=hISwitch]").is(":checked")) {
				hiswitchs = true;
			} else {
				hiswitchs = false;
			}
			if ($("input[name=aCSwitch]").is(":checked")) {
				acswitchs = true;
			} else {
				acswitchs = false;
			}
			if ($("input[name=wISwitch]").is(":checked")) {
				wiswitchs = true;
			} else {
				wiswitchs = false;
			}
			if ($("input[name=mMSwitch]").is(":checked")) {
				mmswitchs = true;
			} else {
				mmswitchs = false;
			}
			if ($("input[name=pCSwitch]").is(":checked")) {
				pcswitchs = true;
			} else {
				pcswitchs = false;
			}
			if ($("input[name=bLSwitch]").is(":checked")) {
				blswitchs = true;
			} else {
				blswitchs = false;
			}
			if ($("input[name=devSwitch]").is(":checked")) {
				devSwitchs = true;
			} else {
				devSwitchs = false;
			}
			var dataa = {
				"policy_id": policyid,
				"fname": "power",
				"config": {
					"filemon": fmswitchs,
					"behavior": bamswitchs,
					"udiskmon": upswitchs,
					"dlmon": dpswitchs,
					"sysprot": srswitchs,
					"instmon": siswitchs,
					"browserprot": bpswitchs,
					"intrusion": hiswitchs,
					"ipattack": acswitchs,
					"malsite": wiswitchs,
					"mail": mmswitchs,
					"ipproto": pcswitchs,
					"ipblacklist": blswitchs,
					"devmgr": devSwitchs
				}
			};

			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {

				}
			});
			//终端升级
			var tipsHide = "";
			var virdbOnly = "";
			if ($("input[name=alertTips]").is(":checked")) {
				tipsHide = true;
			} else {
				tipsHide = false;
			}
			if ($("input[name=virusUp]").is(":checked")) {
				virdbOnly = true;
			} else {
				virdbOnly = false;
			}
			var dataa = { "policy_id": policyid, "fname": "update", "config": { "tips_hide": tipsHide, "virdb_only": virdbOnly } };
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {

				}
			});
			//拓展工具
			// var dataa = { "policy_id": policyid, "fname": "toolbox", "config": {} };
			// var toolbox = ['rclickman', 'sysclean', 'fileshred', 'popblock', 'autoruns', 'netflow', 'leakrepair'];
			// for (var i = 0; i < toolbox.length; i++) {
			// 	if ($("input[name=" + toolbox[i] + "]").is(":checked")) {
			// 		dataa.config[toolbox[i]] = true;
			// 	} else {
			// 		dataa.config[toolbox[i]] = false;
			// 	}
			// }

			// $.ajax({
			// 	url: '/mgr/policy/_update',
			// 	data: JSON.stringify(dataa),
			// 	type: 'POST',
			// 	contentType: 'text/plain',
			// 	error: function (xhr, textStatus, errorThrown) {
			// 		if (xhr.status == 401) {
			// 			parent.window.location.href = '/';
			// 		} else {

			// 		}

			// 	},
			// 	success: function (data) {

			// 	}
			// });

			var overallset1s = "";
			var overallset1v = 20;
			var overallset2s = "";
			var overallset2v = "";
			var skspeeds = "";
			var systemreps = "";
			var actionvs = "";
			var backups = "";
			var startautos = "";
			var startautotype = "";
			if ($("input[name=overallSet1]").is(":checked")) {
				overallset1s = true;
				overallset1v = parseInt($("input[name=overallPara1]").val());
			} else {
				overallset1s = false;
				overallset1v = parseInt($("input[name=overallPara1]").val());
			}
			if ($("input[name=overallSet2]").is(":checked")) {
				overallset2s = true;
				overallset2v = $("input[name=overallPara2]").val();
			} else {
				overallset2s = false;

			}
			if ($("input[name=sKSpeed]:checked").val() == 1) {
				skspeeds = true;
			} else {
				skspeeds = false;
			}
			if ($("input[name=systemRep]").is(":checked")) {
				systemreps = true;
			} else {
				systemreps = false;
			}
			if ($("input[name=actionV]:checked").val() == 1) {
				actionvs = false;
			} else {
				actionvs = true;
			}
			if ($("input[name=backup]").is(":checked")) {
				backups = true;
			} else {
				backups = false;
			}
			if ($("input[name=startAuto]").is(":checked")) {
				startautos = true;
			} else {
				startautos = false;
			}
			if ($("input[name=startAutoType]:checked").val() == 0) {
				startautotype = 0;
			} else {
				startautotype = 1;
			}

			var dataa = {
				"policy_id": policyid,
				"fname": "scan",
				"config": {
					"decompo.limit.size": {
						"enable": overallset1s,
						"value": overallset1v
					},
					"scan.exclusion.ext": {
						"enable": overallset2s,
						"value": overallset2v
					},
					"scan.maxspeed": skspeeds,
					"scan.sysrepair": systemreps,
					"clean.automate": actionvs,
					"clean.quarantine": backups,
					"scan.on.boot": {
						"enable": startautos,
						"type": startautotype
					}
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var scanops = "";
			var debars = "";
			var debarvv = "";
			var virusfinds = "";
			var backupfs = "";
			if ($("input[name=scanOp]:checked").val() == 0) {
				scanops = 0;
			} else if ($("input[name=scanOp]:checked").val() == 1) {
				scanops = 1;
			} else {
				scanops = 2;
			}
			if ($("input[name=debar]").is(":checked")) {
				debars = true;
				debarvv = $("input[name=debarV]").val();
			} else {
				debars = false;
			}
			if ($("input[name=virusFind]:checked").val() == 0) {
				virusfinds = true;
			} else {
				virusfinds = false;
			}
			if ($("input[name=backupF]").is(":checked")) {
				backupfs = true;
			} else {
				backupfs = false;
			}

			var dataa = {
				"policy_id": policyid,
				"fname": "filemon",
				"config": {
					"clean.automate": virusfinds,
					"clean.quarantine": backupfs,
					"scan.leve": scanops,
					"scan.exclusion.file": {
						"enable": debars,
						"value": debarvv
					}
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var virusfindbams = "";
			var backupbams = "";
			var blackmailbams = "";
			if ($("input[name=virusFindBAM]:checked").val() == 0) {
				virusfindbams = true;
			} else {
				virusfindbams = false;
			}
			if ($("input[name=backupBAM]").is(":checked")) {
				backupbams = true;
			} else {
				backupbams = false;
			}
			if ($("input[name=blackMailBAM]").is(":checked")) {
				blackmailbams = true;
			} else {
				blackmailbams = false;
			}
			var dataa = {
				"policy_id": policyid,
				"fname": "behavior",
				"config": {
					"clean.automate": virusfindbams,
					"clean.quarantine": backupbams,
					"bait.enable": blackmailbams
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var cutin1s = "";
			var cutin2s = "";
			var virusfindups = "";
			var backupups = "";
			var zipsets = "";
			var zipsetvv = 20;
			if ($("input[name=cutIn1]").is(":checked")) {
				cutin1s = true;
			} else {
				cutin1s = false;
			}
			if ($("input[name=virusFindUP]:checked").val() == 0) {
				virusfindups = true;
			} else {
				virusfindups = false;
			}
			if ($("input[name=cutIn2]").is(":checked")) {
				cutin2s = true;
			} else {
				cutin2s = false;
			}
			if ($("input[name=backupUP]").is(":checked")) {
				backupups = true;
			} else {
				backupups = false;
			}
			if ($("input[name=zipSet]").is(":checked")) {
				zipsets = true;
				zipsetvv = parseInt($("input[name=zipSetV]").val());
			} else {
				zipsets = false;
				zipsetvv = parseInt($("input[name=zipSetV]").val());
			}
			var dataa = {
				"policy_id": policyid,
				"fname": "udiskmon",
				"config": {
					"clean.automate": virusfindups,
					"clean.quarantine": backupups,
					"repair": cutin1s,
					"scan": cutin2s,
					"decompo.limit.size": {
						"enable": zipsets,
						"value": zipsetvv
					}
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var virusfinddps = "";
			var backupdps = "";
			var zipsetdps = "";
			var zipsetdpvv = 20;
			var debardps = "";
			var debardpvv = "";
			if ($("input[name=virusFindDP]:checked").val() == 0) {
				virusfinddps = true;
			} else {
				virusfinddps = false;
			}
			if ($("input[name=backupDP]").is(":checked")) {
				backupdps = true;
			} else {
				backupdps = false;
			}
			if ($("input[name=zipSetDP]").is(":checked")) {
				zipsetdps = true;
				zipsetdpvv = parseInt($("input[name=zipSetDPV]").val());
			} else {
				zipsetdps = false;
				zipsetdpvv = parseInt($("input[name=zipSetDPV]").val());
			}
			if ($("input[name=debarDP]").is(":checked")) {
				debardps = true;
				debardpvv = $("input[name=debarDPV]").val();
			} else {
				debardps = false;
			}
			var dataa = {
				"policy_id": policyid,
				"fname": "dlmon",
				"config": {
					"clean.automate": virusfinddps,
					"clean.quarantine": backupdps,
					"scan.exclusion.ext": {
						"enable": debardps,
						"value": debardpvv
					},
					"decompo.limit.size": {
						"enable": zipsetdps,
						"value": zipsetdpvv
					}
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			// 邮件监控
			var backupmms = "";
			var zipsetmms = "";
			var zipsetmmvv = 1;
			var port = "";
			var agreement = "";
			var mailrule = "";
			var mailrlist = [];

			if ($("input[name=backupMM]").is(":checked")) {
				backupmms = true;
			} else {
				backupmms = false;
			}
			if ($("input[name=zipSetMM]").is(":checked")) {
				zipsetmms = true;
				zipsetmmvv = parseInt($("input[name=zipSetMMV]").val());
			} else {
				zipsetmms = false;
				zipsetmmvv = parseInt($("input[name=zipSetMMV]").val());
			}

			var emptynum = 0;
			$(".mailMTable .portInput").each(function () {
				if ($(this).val() == "") {
					emptynum = emptynum + 1;
				}
			})

			if (emptynum > 0) {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 端口不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else {
				$(".mailMTable tr").each(function (index, dom) {
					if (index !== 0) {
						port = parseInt($(dom).find(".portInput").val());
						agreement = $(dom).find("select option:selected").html();
						switch (agreement) {
							case "POP3":
								agreement = 1;
								break;
							case "SMTP":
								agreement = 0;
						}
						mailrule = {
							"type": agreement,
							"port": port
						};
						mailrlist.push(mailrule);

					}

				})
				var dataa = {
					"policy_id": policyid,
					"fname": "mail",
					"config": {
						"clean.quarantine": backupmms,
						"decompo.limit.size": {
							"enable": zipsetmms,
							"value": zipsetmmvv
						},
						"list": mailrlist
					}
				};
				$.ajax({
					url: '/mgr/policy/_update',
					data: JSON.stringify(dataa),
					type: 'POST',
					contentType: 'text/plain',
					headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
					success: function (data) {
						hideButton(a);
					}
				});
			}
			// 软件安装拦截
			var actioniis = "";
			var debariis = "";
			var debariivv = "";
			if ($("input[name=actionII]:checked").val() == 0) {
				actioniis = false;
			} else {
				actioniis = true;
			}
			var dataa = {
				"policy_id": policyid,
				"fname": "instmon",
				"config": {
					"autoblock": actioniis,
					"scan.exclusion.file": {
						"enable": debariis
					}
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var startpages = "";
			var webpagev = "";
			if ($("input[name=startpage]:checked").val() == 0) {
				startpages = true;
			} else {
				startpages = false;
				webpagev = $("input[name=webpage]").val();
			}
			var dataa = {
				"policy_id": policyid,
				"fname": "browserprot",
				"config": {
					"startpage.blank": startpages,
					"startpage.site": webpagev
				}
			}
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var actionhis = "";
			if ($("input[name=actionHI]:checked").val() == 0) {
				actionhis = true;
			} else {
				actionhis = false;

			}
			var dataa = {
				"policy_id": policyid,
				"fname": "intrusion",
				"config": {
					"block": actionhis
				}
			}
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var actionacs = "";
			if ($("input[name=actionAC]:checked").val() == 0) {
				actionacs = true;
			} else {
				actionacs = false;

			}
			var dataa = {
				"policy_id": policyid,
				"fname": "ipattack",
				"config": {
					"block": actionacs
				}
			}
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var spys = "";
			var frauds = "";
			var phisings = "";
			if ($("input[name=spy]").is(":checked")) {
				spys = true;
			} else {
				spys = false;

			}
			if ($("input[name=fraud]").is(":checked")) {
				frauds = true;
			} else {
				frauds = false;

			}
			if ($("input[name=phising]").is(":checked")) {
				phisings = true;
			} else {
				phisings = false;

			}

			var dataa = {
				"policy_id": policyid,
				"fname": "malsite",
				"config": {
					"vendor.spy": spys,
					"vendor.fraud": frauds,
					"vendor.phising": phisings
				}
			}
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			var projectn = "";
			var defendi = "";
			var defends = "";
			var efficientt = "";
			var fileptabletd = {};
			var registryptabletd = {};
			var executedtabletd = {};
			var virusitabletd = {};
			var fileptable = {};
			var sysprotconfig = {};
			var registryptable = {};
			var executedtable = {};
			var virusitable = {};
			var whitelist = true;
			var actionitabletd = {};
			var processptabletd = {};
			var actionitable = {};
			var processptable = {};
			if ($("input[name=autoHandle]").is(":checked")) {
				whitelist = true;
			} else {
				whitelist = false;

			}

			$("#filePTable tr").each(function (index, dom) {
				if (index !== 0) {
					projectn = $(dom).find(".projectN").html();
					defendi = $(dom).find(".defendI").html();
					if ($(dom).find(".defendS").is(":checked")) {
						defends = true;
					} else {
						defends = false;
					}
					efficientt = parseInt($(dom).find(".efficientT option:selected").val());
					fileptabletd = {
						"description": defendi,
						"enable": defends,
						"treatment": efficientt
					};

					fileptable[projectn] = fileptabletd;

				}

			})
			$("#registryPTable tr").each(function (index, dom) {
				if (index !== 0) {
					projectn = $(dom).find(".projectN").html();
					defendi = $(dom).find(".defendI").html();
					if ($(dom).find(".defendS").is(":checked")) {
						defends = true;
					} else {
						defends = false;
					}
					efficientt = parseInt($(dom).find(".efficientT option:selected").val());
					registryptabletd = {
						"description": defendi,
						"enable": defends,
						"treatment": efficientt
					};

					registryptable[projectn] = registryptabletd;

				}

			})
			$("#executeDTable tr").each(function (index, dom) {
				if (index !== 0) {
					projectn = $(dom).find(".projectN").html();
					defendi = $(dom).find(".defendI").html();
					if ($(dom).find(".defendS").is(":checked")) {
						defends = true;
					} else {
						defends = false;
					}
					efficientt = parseInt($(dom).find(".efficientT option:selected").val());
					executedtabletd = {
						"description": defendi,
						"enable": defends,
						"treatment": efficientt
					};

					executedtable[projectn] = executedtabletd;

				}

			})
			$("#virusITable tr").each(function (index, dom) {
				if (index !== 0) {
					projectn = $(dom).find(".projectN").html();
					defendi = $(dom).find(".defendI").html();
					if ($(dom).find(".defendS").is(":checked")) {
						defends = true;
					} else {
						defends = false;
					}
					efficientt = parseInt($(dom).find(".efficientT option:selected").val());
					virusitabletd = {
						"description": defendi,
						"enable": defends,
						"treatment": efficientt
					};

					virusitable[projectn] = virusitabletd;

				}

			})
			$("#actionITable tr").each(function (index, dom) {
				if (index !== 0) {
					projectn = $(dom).find(".projectN").html();
					defendi = $(dom).find(".defendI").html();
					if ($(dom).find(".defendS").is(":checked")) {
						defends = true;
					} else {
						defends = false;
					}
					efficientt = parseInt($(dom).find(".efficientT option:selected").val());
					actionitabletd = {
						"description": defendi,
						"enable": defends,
						"treatment": efficientt
					};

					actionitable[projectn] = actionitabletd;

				}

			})
			$("#processPTable tr").each(function (index, dom) {
				if (index !== 0) {
					projectn = $(dom).find(".projectN").html();
					defendi = $(dom).find(".defendI").html();
					if ($(dom).find(".defendS").is(":checked")) {
						defends = true;
					} else {
						defends = false;
					}
					efficientt = parseInt($(dom).find(".efficientT option:selected").val());
					processptabletd = {
						"description": defendi,
						"enable": defends,
						"treatment": efficientt
					};

					processptable[projectn] = processptabletd;

				}

			})
			sysprotconfig = {
				"protect.file": fileptable,
				"protect.reg": registryptable,
				"protect.run": executedtable,
				"protect.risk": actionitable,
				"protect.process": processptable,
				"protect.immune": virusitable,
				"whitelist.enable": whitelist
			};
			var dataa = {
				"policy_id": policyid,
				"fname": "sysprot",
				"config": sysprotconfig
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {

				}
			});

			// ip协议控制
			var prolist = [];
			$(".protocolCTable tr").each(function (index, dom) {

				if (index !== 0) {
					var newdom = $(dom).find("td").eq(2);
					var block = parseInt(newdom.find(".ope").attr("opev"));
					if (newdom.find(".remoteip").html() == "任意IP") {
						var raddr = "*";
					} else {
						var raddr = newdom.find(".remoteip").html();
					}
					var name = $(dom).find("td").eq(1).children().html();
					var icmp_type = parseInt(newdom.find(".pro").attr("icmp"));
					if (newdom.find(".localport").html() == "任意端口") {
						var lport = "*";
					} else if (newdom.find(".localport").html() == "无") {
						var lport = "";
					} else {
						var lport = newdom.find(".localport").html();
					}
					var direction = parseInt(newdom.find(".dir").attr("dirv"));
					var protocol = parseInt(newdom.find(".pro").attr("prov"));
					if (newdom.find(".localip").html() == "任意IP") {
						var laddr = "*";
					} else {
						var laddr = newdom.find(".localip").html();
					}
					if (newdom.find(".remoteport").html() == "任意端口") {
						var rport = "*";
					} else if (newdom.find(".remoteport").html() == "无") {
						var rport = "";
					} else {
						var rport = newdom.find(".remoteport").html();
					}
					if ($(dom).find("td").eq(3).find("input").is(":checked")) {
						var enabled = true;
					} else {
						var enabled = false;
					}
					var ipproto = {
						"block": block,
						"raddr": raddr,
						"name": name,
						"icmp_type": icmp_type,
						"lport": lport,
						"direction": direction,
						"protocol": protocol,
						"laddr": laddr,
						"rport": rport,
						"enabled": enabled
					};

					prolist.push(ipproto);

				}

			})
			var dataa = {
				"policy_id": policyid,
				"fname": "ipproto",
				"config": {
					"list": prolist
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					hideButton(a);
				}
			});
			// ip黑名单
			var blacklist = [];
			$(".blackLTable tr").each(function (index, dom) {

				if (index !== 0) {
					var newdom = $(dom).find("td").eq(1);
					var raddr_type = parseInt(newdom.attr("raddr_type"));
					var raddr = _ip2int(newdom.find(".ipstart").html());
					if (raddr_type == 1) {
						var raddr_end = _ip2int(newdom.find(".ipend").html());
					}

					var memo = $(dom).find("td").eq(2).find('span').html();
					if (raddr_type == 0) {
						var blackip = {
							"raddr_type": raddr_type,
							"raddr": raddr,
							"memo": memo
						};
					} else {
						var blackip = {
							"raddr_type": raddr_type,
							"raddr": raddr,
							"raddr_end": raddr_end,
							"memo": memo
						};
					}
					blacklist.push(blackip);

				}

			})
			var dataa = {
				"policy_id": policyid,
				"fname": "ipblacklist",
				"config": {
					"list": blacklist
				}
			};
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				success: function (data) {
					hideButton(a);
				}
			});

			//设备控制
			var udisk = "";
			var portable = "";
			var usbWifi = "";
			var usbNetcard = "";
			var printer = "";
			var cdrom = "";
			var bluetooth = "";
			var tipsHide = "";
			if ($("input[name=udisk]").is(":checked")) {
				udisk = true;
			} else {
				udisk = false;

			}
			if ($("input[name=portable]").is(":checked")) {
				portable = true;
			} else {
				portable = false;

			}
			if ($("input[name=usb-wifi]").is(":checked")) {
				usbWifi = true;
			} else {
				usbWifi = false;

			}
			if ($("input[name=usb-netcard]").is(":checked")) {
				usbNetcard = true;
			} else {
				usbNetcard = false;
			}
			if ($("input[name=printer]").is(":checked")) {
				printer = true;
			} else {
				printer = false;

			}
			if ($("input[name=cdrom]").is(":checked")) {
				cdrom = true;
			} else {
				cdrom = false;

			}
			if ($("input[name=bluetooth]").is(":checked")) {
				bluetooth = true;
			} else {
				bluetooth = false;

			}
			if ($("input[name=tipsHide]").is(":checked")) {
				tipsHide = true;
			} else {
				tipsHide = false;

			}

			var dataa = {
				"policy_id": policyid,
				"fname": "devmgr",
				"config": {
					"tips.hide": tipsHide,
					"settings": {
						"udisk": udisk,
						"portable": portable,
						"usb-wifi": usbWifi,
						"usb-netcard": usbNetcard,
						"printer": printer,
						"cdrom": cdrom,
						"bluetooth": bluetooth
					}
				}
			}
			$.ajax({
				url: '/mgr/policy/_update',
				data: JSON.stringify(dataa),
				type: 'POST',
				contentType: 'text/plain',
				headers: {"HTTP_CSRF_TOKEN": getCookie('HRESSCSRF')},
				error: function (xhr, textStatus, errorThrown) {
					if (xhr.status == 401) {
						parent.window.location.href = '/';
					} else {

					}

				},
				success: function (data) {

				}
			});

		}

		// 邮件监控dom操作

		function addMRB() {
			var emptynum = 0;
			$(".mailMTable .portInput").each(function () {
				if ($(this).val() == "") {
					emptynum = emptynum + 1;
				}
			})
			if (emptynum == 0) {
				var mailtabletr = "";
				mailtabletr += "<tr>";
				mailtabletr += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";
				mailtabletr += "<td><input type='text' class='portInput' maxlength='5'></td>";
				mailtabletr += "<td><select><option value=0>SMTP</option><option value=1>POP3</option></select></td>";
				mailtabletr += "<td><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
				mailtabletr += "</tr>";
				$(".mailMTable table tr").eq(0).after(mailtabletr);
				$(".mailMTable .portInput").eq(0).focus();

			} else {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 端口不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
				$(".mailMTable .portInput").eq(0).focus();
			}

		}

		function deleteMRB(a) {
			$(a).parents("tr").remove();
		}

		function deleteSMRB(a) {
			$(".mailMTable .selectFP:checked").each(function () {
				$(this).parents("tr").remove();
			})
			$(".mailMTable th input[type=checkbox]").prop("checked", false);
			$(a).removeClass("greenfont");
			$(a).removeClass("cursor");
		}

		$(".mailMTable").on("blur", ".portInput", function () {

			var thisinput = $(this);
			var thisvalue = $(this).val();

			var index = 0;
			$(".mailMTable .portInput").each(function () {
				if ($(this).val() == trim(thisvalue)) {
					index = index + 1;
				}
			})
			if (trim($(this).val()) == "") {
				// setTimeout(function () {
				// 	$(".mailMTable .portInput").eq(0).focus()
				// }, 500);
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 端口不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			}
			if (index > 1) {
				// setTimeout(function () {
				// 	$(".mailMTable .portInput").eq(0).focus()
				// }, 500);
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 端口不能重复");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
				$(this).val("");

			}

		})
		$(".mailMTable").on("change", ".selectFP,th input[type=checkbox]", function () {
			if ($(".mailMTable .selectFP:checked").length > 0) {
				$(".mMTableTitle .floatR .deleteMRB").addClass("greenfont");
				$(".mMTableTitle .floatR .deleteMRB").addClass("underline");
				$(".mMTableTitle .floatR .deleteMRB").addClass("cursor");

			} else {
				$(".mMTableTitle .floatR .deleteMRB").removeClass("greenfont");
				$(".mMTableTitle .floatR .deleteMRB").removeClass("underline");
				$(".mMTableTitle .floatR .deleteMRB").removeClass("cursor");
			}
		})

		// IP黑名单dom操作
		function addBLB() {
			$(".windowShade").show();
			$(".addBLPop").show();
			$(".addBLPop select").val(0);
			$(".addBLPop p").eq(1).children("span").hide();
			$(".addBLPop .ip").val("");
			$(".addBLPop .remark").val("");
		}
		$(".addBLPop select,.editBLPop select").change(function (event) {
			if ($(this).val() == 0) {
				$(this).parent().next().children('span').hide()
			} else {
				$(this).parent().next().children('span').show()
			}
		})

		function editBLB(self) {
			$(self).parents("tr").siblings("tr").attr("id", "");
			$(self).parents("tr").attr("id", "editing");
			$(".windowShade").show();
			$(".editBLPop").show();
			var newdom = $(self).parents("tr").find("td").eq(1);
			if (newdom.attr('raddr_type') == 0) {
				$(".editBLPop select").val(0);
				$(".editBLPop .ip").eq(0).val(newdom.find(".ipstart").html());
				$(".editBLPop .ip").eq(0).next().hide();

			} else {
				$(".editBLPop select").val(1);
				$(".editBLPop .ip").eq(0).val(newdom.find(".ipstart").html());
				$(".editBLPop .ip").eq(1).val(newdom.find(".ipend").html());
				$(".editBLPop .ip").eq(0).next().show();
			}
			$(".editBLPop .remark").val($(self).parents("tr").find("td").eq(2).find("span").text())

		}



		//判断ip是否存在
		var blackIpArr = [];
		function balckIpFun() {
			blackIpArr = [];
			var eIndex = $('#editing').index();
			$(".blackLTable tr").each(function (index, dom) {
				if (index !== 0 && eIndex != index) {
					var newdom = $(dom).find("td").eq(1);
					var raddr_type = parseInt(newdom.attr("raddr_type"));

					if (raddr_type == 1) {
						var raddr = newdom.find(".ipstart").html() + '-' + newdom.find(".ipend").html();
					} else {
						var raddr = newdom.find(".ipstart").html();

					}
					blackIpArr.push(raddr);
				}

			})
		}
		//判断ip协议是否存在
		var protocolArr = [];
		function protocolIpFun() {
			protocolArr = [];
			var eIndex = $('#editing').index();
			$(".protocolCTable tr").each(function (index, dom) {
				if (index !== 0 && eIndex != index) {
					var raddr = $(dom).find("td").eq(1).find('span').html();
					protocolArr.push(raddr);
				}

			})
		}

		// 确定添加ip黑名单
		function sureAddBLB(self) {
			if ($(".addBLPop select").val() == 0 && isValidIP($(".addBLPop .ip").eq(0).val()) == false) {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> ip有误");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".addBLPop select").val() == 1 && isValidIP($(".addBLPop .ip").eq(0).val()) == false) {

				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> ip有误");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);

			} else if ($(".addBLPop select").val() == 1 && isValidIP($(".addBLPop .ip").eq(1).val()) == false) {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> ip有误");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else {
				var blackLTable = "";
				blackLTable += "<tr>";
				blackLTable += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";
				if ($(".addBLPop select").val() == 0) {
					blackLTable += "<td raddr_type=0>";
				} else {
					blackLTable += "<td raddr_type=1>";
				}

				blackLTable += "<span class='ipstart'>" + $(".addBLPop .ip").eq(0).val() + "</span>";
				if ($(".addBLPop select").val() == 1) {
					blackLTable += "-" + "<span class='ipend'>" + $(".addBLPop .ip").eq(1).val() + "</span>";
				}
				blackLTable += "</td>";
				blackLTable += "<td><span class='txtWidth' title=" + pathtitle(safeStr($(".addBLPop .remark").val())) + ">" +
					safeStr($(".addBLPop .remark").val()) + "</span></td>";
				blackLTable +=
					"<td><a class='underline blackfont opButton cursor' onclick='editBLB(this)'>编辑</a><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
				blackLTable += "</tr>";
				var ip1 = $(".addBLPop .ip").eq(0).val();
				var ip2 = $(".addBLPop .ip").eq(0).val() + '-' + $(".addBLPop .ip").eq(1).val();
				//获取已存在的ip
				balckIpFun();
				if ($(".addBLPop .hidden").css('display') == 'none') {
					if (ip1 && isInArray(blackIpArr, ip1)) {
						$(".delayHide").show();
						$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'>此ip已存在");
						setTimeout(function () { $(".delayHide").hide() }, 2000);
						return false;
					}

				} else {
					if (isInArray(blackIpArr, ip2)) {
						$(".delayHide").show();
						$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'>此ip已存在");
						setTimeout(function () { $(".delayHide").hide() }, 2000);
						return false;
					}
				}

				$(".blackLTable table").append(blackLTable);
				$(self).parents(".windowPop").hide();
				$(self).parents(".windowPop").siblings(".windowShade").hide();
			}

		}

		function sureEditBLB(self) {
			if ($(".editBLPop select").val() == 0 && isValidIP($(".editBLPop .ip").eq(0).val()) == false) {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> ip有误");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".editBLPop select").val() == 1 && isValidIP($(".editBLPop .ip").eq(0).val()) == false) {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> ip有误");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".editBLPop select").val() == 1 && isValidIP($(".editBLPop .ip").eq(1).val()) == false) {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> ip有误");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else {
				// $(".blackLTable #editing").remove();
				var blackLTable = "";
				// blackLTable += "<tr>";
				blackLTable += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";
				if ($(".editBLPop select").val() == 0) {
					blackLTable += "<td raddr_type=0>";
				} else {
					blackLTable += "<td raddr_type=1>";
				}

				blackLTable += "<span class='ipstart'>" + $(".editBLPop .ip").eq(0).val() + "</span>";
				if ($(".editBLPop select").val() == 1) {
					blackLTable += "-" + "<span class='ipend'>" + $(".editBLPop .ip").eq(1).val() + "</span>";
				}
				blackLTable += "</td>";
				blackLTable += "<td><span class='txtWidth' title=" + pathtitle(safeStr($(".editBLPop .remark").val())) + ">" +
					safeStr($(".editBLPop .remark").val()) + "</span></td>";
				blackLTable +=
					"<td><a class='underline blackfont opButton cursor' onclick='editBLB(this)'>编辑</a><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
				// blackLTable += "</tr>";
				var ip1 = $(".editBLPop .ip").eq(0).val();
				var ip2 = $(".editBLPop .ip").eq(0).val() + '-' + $(".editBLPop .ip").eq(1).val();
				//获取已存在的ip
				balckIpFun();
				if ($(".editBLPop .hidden").css('display') == 'none') {
					if (ip1 && isInArray(blackIpArr, ip1)) {
						$(".delayHide").show();
						$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'>此ip已存在");
						setTimeout(function () { $(".delayHide").hide() }, 2000);
						return false;
					}
				} else {
					if (isInArray(blackIpArr, ip2)) {
						$(".delayHide").show();
						$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'>此ip已存在");
						setTimeout(function () { $(".delayHide").hide() }, 2000);
						return false;
					}
				}

				$(".blackLTable #editing").html(blackLTable);
				$(".blackLTable #editing").removeAttr('id');
				$(self).parents(".windowPop").hide();
				$(self).parents(".windowPop").siblings(".windowShade").hide();
			}

		}
		// IP协议控制dom操作
		function addPCB() {
			$(".windowShade").show();
			$(".addPCPop").show();
			$(".addPCPop input[name=ruleName]").val("");
			$(".addPCPop .ope").val(0);
			$(".addPCPop .dir").val(0);
			$(".addPCPop .pro").val(6);
			$('.addPCPop .localport').val(0);
			$('.addPCPop .localport').prop("disabled", false);
			$('.addPCPop .remoteport').val(0);
			$('.addPCPop .remoteport').prop("disabled", false);
			$(".addPCPop .ipports").val(0);
			$(".addPCPop input").not(":first").hide();
			$(".addPCPop .hintIco").hide();
		}

		function editPCB(self) {
			$(self).parents("tr").siblings("tr").attr("id", "");
			$(self).parents("tr").attr("id", "editing");
			$(".windowShade").show();
			$(".editPCPop").show();
			var newdom = $(self).parents("tr").find("td").eq(2);
			$(".editPCPop .ope").val(newdom.find(".ope").attr("opev"));
			$(".editPCPop .dir").val(newdom.find(".dir").attr("dirv"));
			$(".editPCPop .pro").val(newdom.find(".pro").attr("prov"));
			if (newdom.find(".pro").attr("prov") == 1) {
				$(".editPCPop .ICMP").show();
			} else {
				$(".editPCPop .ICMP").hide();
			}
			$(".editPCPop input[name=ruleName]").val($(self).parents("tr").find("td").eq(1).find("span").text());
			$(".editPCPop .ICMP").val(newdom.find(".pro").attr("icmp"));
			if (newdom.find(".localip").html() == "任意IP") {
				$(".editPCPop .localip").val(0);
				$(".editPCPop .localipv").hide();
				$(".editPCPop .localipv").next().hide();
			} else {
				$(".editPCPop .localip").val(1);
				$(".editPCPop .localipv").show();
				$(".editPCPop .localipv").val(newdom.find(".localip").html());
				$(".editPCPop .localipv").next().show();

			}
			if (newdom.find(".localport").html() == "任意端口") {
				$(".editPCPop .localport").val(0).prop("disabled", false);
				$(".editPCPop .localportv").hide();
				$(".editPCPop .localportv").next().hide();
			} else if (newdom.find(".localport").html() == "无") {
				$(".editPCPop .localport").val(3).prop("disabled", true);
				$(".editPCPop .localportv").hide();
				$(".editPCPop .localportv").next().hide();
			} else {
				$(".editPCPop .localport").val(1).prop("disabled", false);
				$(".editPCPop .localportv").show();
				$(".editPCPop .localportv").val(newdom.find(".localport").html());
				$(".editPCPop .localportv").next().show();

			}
			if (newdom.find(".remoteip").html() == "任意IP") {
				$(".editPCPop .remoteip").val(0);
				$(".editPCPop .remoteipv").hide();
				$(".editPCPop .remoteipv").next().hide();
			} else {
				$(".editPCPop .remoteip").val(1);
				$(".editPCPop .remoteipv").show();
				$(".editPCPop .remoteipv").val(newdom.find(".remoteip").html());
				$(".editPCPop .remoteipv").next().show();

			}
			if (newdom.find(".remoteport").html() == "任意端口") {
				$(".editPCPop .remoteport").val(0).prop("disabled", false);
				$(".editPCPop .remoteportv").hide();
				$(".editPCPop .remoteportv").next().hide();
			} else if (newdom.find(".remoteport").html() == "无") {
				$(".editPCPop .remoteport").val(3).prop("disabled", true);
				$(".editPCPop .remoteportv").hide();
				$(".editPCPop .remoteportv").next().hide();
			} else {
				$(".editPCPop .remoteport").val(1).prop("disabled", false);
				$(".editPCPop .remoteportv").show();
				$(".editPCPop .remoteportv").val(newdom.find(".remoteport").html());
				$(".editPCPop .remoteportv").next().show();

			}

		}
		// 添加和编辑改变协议时的变化
		$(".addPCPop .pro,.editPCPop .pro").change(function () {
			if ($(this).val() == 1) {
				$(this).siblings(".ICMP").show();
			} else {
				$(this).siblings(".ICMP").hide();
			}
			if ($(this).val() == 6 || $(this).val() == 17 || $(this).val() == 260) {
				$(this).parents(".windowPop").find('.localport').val(0);
				$(this).parents(".windowPop").find('.localport').prop("disabled", false);
				$(this).parents(".windowPop").find('.localportv').hide();
				$(this).parents(".windowPop").find('.localportv').next().hide();
				$(this).parents(".windowPop").find('.remoteport').val(0);
				$(this).parents(".windowPop").find('.remoteport').prop("disabled", false);
				$(this).parents(".windowPop").find('.remoteportv').hide();
				$(this).parents(".windowPop").find('.remoteportv').next().hide();
			} else {
				$(this).parents(".windowPop").find('.localport').val(3);
				$(this).parents(".windowPop").find('.localport').prop("disabled", true);
				$(this).parents(".windowPop").find('.localportv').hide();
				$(this).parents(".windowPop").find('.localportv').next().hide();
				$(this).parents(".windowPop").find('.remoteport').val(3);
				$(this).parents(".windowPop").find('.remoteport').prop("disabled", true);
				$(this).parents(".windowPop").find('.remoteportv').hide();
				$(this).parents(".windowPop").find('.remoteportv').next().hide();
			}
		})
		// 确定添加ip协议控制
		function sureAddPCB(self) {
			if (trim($(".addPCPop input[name=ruleName]").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 规则名不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".addPCPop .localip").val() == 1 && trim($(".addPCPop .localipv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 本地ip不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".addPCPop .remoteip").val() == 1 && trim($(".addPCPop .remoteipv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 远程ip不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".addPCPop .localport").val() == 1 && trim($(".addPCPop .localportv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 本地端口不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".addPCPop .remoteport").val() == 1 && trim($(".addPCPop .remoteportv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 远程端口不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else {
				var protocolCTable = "";

				protocolCTable += "<tr>";

				protocolCTable += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";
				protocolCTable += "<td><span>" + safeStr($(".addPCPop input[name=ruleName]").val()) + "</span></td>";

				protocolCTable += "<td>" + "操作:<span class='ope' opev=" + $(".addPCPop .ope option:selected").val() + ">" + $(
					".addPCPop .ope option:selected").html() + "</span> 方向:<span class='dir' dirv=" + $(
						".addPCPop .dir option:selected").val() + ">" + $(".addPCPop .dir option:selected").html() +
					"</span> 协议:<span class='pro' prov=" + $(".addPCPop .pro option:selected").val() + " icmp=" + $(
						".addPCPop .ICMP option:selected").val() + ">" + $(".addPCPop .pro option:selected").html() +
					"</span><br/>";
				if ($(".addPCPop .localip").val() == 0) {
					protocolCTable += "<span class='introWidth'>本地IP:<span class='localip'>任意IP</span>";
				} else {
					protocolCTable += "<span class='introWidth'>本地IP:<span class='localip'>" + $(".addPCPop .localipv")
						.val() + "</span>";
				}
				if ($(".addPCPop .localport").val() == 0) {
					protocolCTable += "&nbsp;本地端口:<span class='localport'>任意端口</span>";
				} else if ($(".addPCPop .localport").val() == 3) {
					protocolCTable += "&nbsp;本地端口:<span class='localport'>无</span>";
				} else {
					protocolCTable += "&nbsp;本地端口:<span class='localport'>" + $(".addPCPop .localportv").val() + "</span>";
				}
				if ($(".addPCPop .remoteip").val() == 0) {
					protocolCTable += "&nbsp;远程IP:<span class='remoteip'>任意IP</span>";
				} else {
					protocolCTable += "&nbsp;远程IP:<span class='remoteip'>" + $(".addPCPop .remoteipv").val() + "</span>";
				}
				if ($(".addPCPop .remoteport").val() == 0) {
					protocolCTable += "&nbsp;远程端口:<span class='remoteport'>任意端口</span>";
				} else if ($(".addPCPop .remoteport").val() == 3) {
					protocolCTable += "&nbsp;远程端口:<span class='remoteport'>无</span>";
				} else {
					protocolCTable += "&nbsp;远程端口:<span class='remoteport'>" + $(".addPCPop .remoteportv").val() + "</span>";
				}
				protocolCTable += "</span>";
				protocolCTable += "</td>";
				protocolCTable += "<td>" + "<input type='checkbox' class='verticalMiddle' checked>" + "</td>";
				protocolCTable +=
					"<td><a class='underline blackfont opButton cursor' onclick='editPCB(this)'>编辑</a><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
				protocolCTable += "</tr>";

				//获取已存在的规则名
				protocolIpFun();
				var ip1 = $(".addPCPop input[name=ruleName]").val();

				if (isInArray(protocolArr, ip1)) {
					$(".delayHide").show();
					$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'>此规则名已存在");
					setTimeout(function () { $(".delayHide").hide() }, 2000);
					return false;
				}
				$(".protocolCTable table").append(protocolCTable);
				$(self).parents(".windowPop").hide();
				$(self).parents(".windowPop").siblings(".windowShade").hide();
			}

		}
		// 确定编辑ip协议控制
		function sureEditPCB(self) {
			if (trim($(".editPCPop input[name=ruleName]").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 规则名不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".editPCPop .localip").val() == 1 && trim($(".editPCPop .localipv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 本地ip不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".editPCPop .remoteip").val() == 1 && trim($(".editPCPop .remoteipv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 远程ip不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".editPCPop .localport").val() == 1 && trim($(".editPCPop .localportv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 本地端口不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else if ($(".editPCPop .remoteport").val() == 1 && trim($(".editPCPop .remoteportv").val()) == "") {
				$(".delayHide").show();
				$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'> 远程端口不能为空");
				setTimeout(function () {
					$(".delayHide").hide()
				}, 2000);
			} else {

				var protocolCTable = "";

				// protocolCTable += "<tr>";

				protocolCTable += "<td><input type='checkbox' class='selectFP verticalMiddle'></td>";
				protocolCTable += "<td><span>" + safeStr($(".editPCPop input[name=ruleName]").val()) + "</span></td>";

				protocolCTable += "<td>" + "操作:<span class='ope' opev=" + $(".editPCPop .ope option:selected").val() + ">" +
					$(".editPCPop .ope option:selected").html() + "</span> 方向:<span class='dir' dirv=" + $(
						".editPCPop .dir option:selected").val() + ">" + $(".editPCPop .dir option:selected").html() +
					"</span> 协议:<span class='pro' prov=" + $(".editPCPop .pro option:selected").val() + " icmp=" + $(
						".editPCPop .ICMP option:selected").val() + ">" + $(".editPCPop .pro option:selected").html() +
					"</span><br/>";
				if ($(".editPCPop .localip").val() == 0) {
					protocolCTable += "<span class='introWidth'>本地IP:<span class='localip'>任意IP</span>";
				} else {
					protocolCTable += "<span class='introWidth'>本地IP:<span class='localip'>" + $(".editPCPop .localipv")
						.val() + "</span>";
				}
				if ($(".editPCPop .localport").val() == 0) {
					protocolCTable += "&nbsp;本地端口:<span class='localport'>任意端口</span>";
				} else if ($(".editPCPop .localport").val() == 3) {
					protocolCTable += "&nbsp;本地端口:<span class='localport'>无</span>";
				} else {
					protocolCTable += "&nbsp;本地端口:<span class='localport'>" + $(".editPCPop .localportv").val() + "</span>";
				}
				if ($(".editPCPop .remoteip").val() == 0) {
					protocolCTable += "&nbsp;远程IP:<span class='remoteip'>任意IP</span>";
				} else {
					protocolCTable += "&nbsp;远程IP:<span class='remoteip'>" + $(".editPCPop .remoteipv").val() + "</span>";
				}
				if ($(".editPCPop .remoteport").val() == 0) {
					protocolCTable += "&nbsp;远程端口:<span class='remoteport'>任意端口</span>";
				} else if ($(".editPCPop .remoteport").val() == 3) {
					protocolCTable += "&nbsp;远程端口:<span class='remoteport'>无</span>";
				} else {
					protocolCTable += "&nbsp;远程端口:<span class='remoteport'>" + $(".editPCPop .remoteportv").val() + "</span>";
				}
				protocolCTable += "</span>";
				protocolCTable += "</td>";
				if ($(".protocolCTable #editing").find('input').eq(1).is(":checked")) {
					protocolCTable += "<td>" + "<input type='checkbox' class='verticalMiddle' checked>" + "</td>";
				} else {
					protocolCTable += "<td>" + "<input type='checkbox' class='verticalMiddle'>" + "</td>";
				}
				protocolCTable +=
					"<td><a class='underline blackfont opButton cursor' onclick='editPCB(this)'>编辑</a><a class='underline blackfont opButton cursor' onclick='deleteMRB(this)'>删除</a></td>";
				// protocolCTable += "</tr>";

				var ip1 = $(".editPCPop input[name=ruleName]").val();
				//获取已存在的规则名
				protocolIpFun();

				if (isInArray(protocolArr, ip1)) {
					$(".delayHide").show();
					$(".delayHide .p1").html("<img src='images/unusualw.png' class='verticalMiddle'>此规则名已存在");
					setTimeout(function () { $(".delayHide").hide() }, 2000);
					return false;
				}

				$(".protocolCTable table #editing").html(protocolCTable);
				$(".protocolCTable #editing").removeAttr('id');
				$(self).parents(".windowPop").hide();
				$(self).parents(".windowPop").siblings(".windowShade").hide();
			}

		}
		// 提示图标
		$(".hintIco").mouseenter(function () {
			$(this).next().show();
		})
		$(".hintIco").mouseleave(function () {
			$(this).next().hide();
		})
		// ip或端口选择任意或自定义时隐藏显示后面input
		$(".ipports").change(function (event) {
			if ($(this).val() == 0) {
				$(this).next().hide();
				$(this).next().next().hide();
			} else {
				$(this).next().show();
				$(this).next().next().show();
			}
		});
		//调整页面内元素高度
		var mainlefth = parent.$("#iframe #mainFrame").height();

		$(".main .tacticsTable").css({
			height: mainlefth - 294
		});
		window.onresize = function () {
			var mainlefth = parent.$("#iframe #mainFrame").height();

			$(".main .tacticsTable").css({
				height: mainlefth - 294
			});
		}

		//输入框限制数字大小
		$("input[name=overallPara1],input[name=zipSetDPV],input[name=zipSetV]").keyup(function () {

			if ($(this).val() > 9999) {
				$(this).val(9999);
			}
		})
		$("input[name=overallPara1],input[name=zipSetDPV],input[name=zipSetV]").blur(function () {

			if ($(this).val() < 20) {
				$(this).val(20);
			}
		})
		$("input[name=zipSetMMV]").keyup(function () {

			if ($(this).val() > 20) {
				$(this).val(20);
			}
		})
		$("input[name=zipSetMMV]").blur(function () {

			if ($(this).val() < 1) {
				$(this).val(1);
			}
		})
	</script>
	<script>
		//隐藏左边滚动条   
		$(function () {
			$(".mainBlock .left").panel({
				iWheelStep: 32
			});
		});
	</script>
</body>

</html>